{"version":3,"sources":["tools/analytics.ts","tools/gif.ts","Component/Modal.tsx","hooks/boolean.ts","tools/canvas.ts","context/loading.ts","Component/Style/Back.tsx","hooks/shortcut.ts","tools/key.ts","Component/Player.tsx","Component/Adder/Adder.tsx","Component/Adder/Adder/SpriteSelector.tsx","Component/Loading.tsx","Component/Wtf.tsx","Component/Like.tsx","hooks/mounted.ts","Component/Adder/Adder/SourceSelector/UrlSource.tsx","hooks/focus.ts","Component/Adder/Adder/SourceSelector/FileSource.tsx","Component/Adder/Adder/SourceSelector.tsx","Component/Adder/Adder/LoopConfigurator/Handle.tsx","Component/Adder/Adder/LoopConfigurator/Cutter.tsx","Component/Adder/Adder/LoopConfigurator/SampleModeSelector.tsx","Component/Adder/Adder/LoopConfigurator.tsx","tools/zip.ts","Component/Loops.tsx","hooks/leave.ts","App.tsx","serviceWorker.ts","Component/Error.tsx","index.tsx"],"names":["UserEvent","sessionId","Date","now","userId","getUserId","localStorage","getItem","replace","c","r","Math","random","toString","setItem","sendError","type","error","console","sendEvent","ErrorOccured","a","event","fetch","method","mode","cache","headers","body","JSON","stringify","api_key","process","events","user_id","session_id","device_id","event_type","time","event_properties","app_version","Sample","blockedProviders","getBase64","file","Promise","resolve","reader","FileReader","onload","target","result","readAsDataURL","getImage","url","image","Image","src","getGifLength","gif","length","delay","getGifStepLength","getDataUrl","reject","xhr","XMLHttpRequest","response","onloadend","onerror","some","provider","indexOf","find","open","responseType","send","getSuperGif","superGif","SuperGif","auto_play","load","getGif","urlData","document","createElement","appendChild","get_frames","Container","styled","div","props","isVisible","Mask","Modal","theme","addModal","windowSize","spacing","color","white","Header","grey","Dismiss","Title","useBooleanState","defaultValue","useState","value","setValue","FRAME_WIDTH","FRAME_HEIGHT","addImageToCanvas","context","imageData","croppedWidth","width","croppedHeight","top","height","putImageData","getAnimate","configuration","Trim","getTrimedFrames","getSampledFrames","frameCount","floor","Array","map","_value","index","getFrame","filterGif","start","end","previousPosition","filter","frame","position","animate","canvas","cpt","trimedGif","frames","setInterval","data","getContext","drawImage","scaleImage","scale","totalFrames","frameNumber","frameStep","getImages","key","Error","getImageData","getOffsetY","generateSprite","images","toDataURL","LoadingContext","createContext","Back","leading","css","vertical","useShortcut","callback","memoizedCallback","useCallback","code","useEffect","addEventListener","removeEventListener","Key","Canvas","cssWidth","Player","canvasRef","useRef","current","timer","clearInterval","ref","Scroller","level","getLevel","Adder","initialSprite","onLoopAdd","dismissModal","setGif","setConfiguration","sprite","setSprite","show","useContext","loading","setImmediate","dismiss","CancelAdd","from","Escape","onClick","isLoading","previous","onGifSelected","newGif","onLoopConfirmation","onSpriteConfirmation","black","Grid","Sprite","SpriteSelector","_content","Bar","Progress","lightGrey","Loading","Content","Version","Wtf","href","Donate","input","Form","form","Like","action","name","title","alt","useMounted","beforeUnmount","isMountedRef","yellow","selected","sourceCount","Button","visible","Input","Submit","span","ErrorDisplay","red","UrlSource","onSelected","setUrl","setLoading","isMounted","setError","urlRef","setFocus","focus","useAutoFocus","Source","Url","setTimeout","submit","gifData","GifSelected","placeholder","onChange","currentTarget","onKeyPress","blue","DropZone","Explanation","FileSource","files","message","File","source","SourceSelector","setSource","HandlePosition","Grabber","HandleGrabber","Pin","StartHandle","EndHandle","HandleTime","Handle","handlePosition","min","max","onEnd","Element","Start","parentWidth","setParentWidth","currentPosition","setCurrentPosition","grabberStartX","setGrabberStartX","startingPosition","setStartingPosition","isDragged","setIsDragged","containerRef","parentNode","getBoundingClientRect","mouseUp","preventDefault","window","mouseDown","clientX","round","mouseMove","newPosition","newValue","style","left","onMouseDown","onMouseMove","getTimeLabel","Timeline","Timing","Spacer","CutBoard","End","TrimStart","TrimEnd","TrimCenter","label","includes","Cutter","state","setState","onStartChange","newStart","onEndChange","newEnd","Mode","SampleModeSelector","Configurator","LoopConfigurator","ThemeContext","tooShort","setTooShort","onModeChange","newMode","newStartEnd","onCutChange","ConfigurationChange","generateZip","loops","zip","JSZip","folder","loop","base64","generateAsync","then","content","Item","Actions","Action","Loops","onOpenAddLoop","onRemoveLoop","onOpenInfoLoop","onOpenLikeLoop","nonEmptyLoops","undefined","beforeUnloadMessage","Footer","AddButton","DownloadButton","App","isAddModalOpen","openAddModal","closeAddModal","isInfoModalOpen","openInfoModal","closeInfoModal","isLikeModalOpen","openLikeModal","closeLikeModal","setLoops","setLoop","newLoop","updatedLoops","removeLoop","loopToRemove","useLoopState","currentSprite","canLeave","handleUnload","returnValue","useBeforeLeave","Provider","OpenWtf","LoopRemoved","OpenLike","StartAdding","loop_number","Download","loop_count","saveAs","LoopAdded","CloseWtf","CloseLike","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","log","onUpdate","onSuccess","catch","ErrorBoundary","hasError","errorInfo","this","Fragment","children","React","Component","AppLaunch","ReactDOM","render","StrictMode","getElementById","URL","origin","contentType","get","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.e5eb9268.chunk.js","sourcesContent":["const AMPLITUDE_URL = 'https://api.amplitude.com/2/httpapi';\n\nconst uuidv4 = () => {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n    var r = (Math.random() * 16) | 0,\n      v = c === 'x' ? r : (r & 0x3) | 0x8;\n    return v.toString(16);\n  });\n};\n\nenum UserEvent {\n  AppLaunch = 'app_launch_event',\n  ErrorOccured = 'error_occured_event',\n  StartAdding = 'start_adding_event',\n  GifSelected = 'gif_selected_event',\n  CancelAdd = 'cancel_add_event',\n  LoopAdded = 'loop_added_event',\n  LoopRemoved = 'loop_removed_event',\n  Download = 'download_event',\n  OpenWtf = 'open_wtf_event',\n  CloseWtf = 'close_wtf_event',\n  OpenLike = 'open_like_event',\n  CloseLike = 'close_like_event',\n  ConfigurationChange = 'configuration_change_event',\n}\n\n// Everytime you relaunch the app, I generate a unique id from nothing to identifiy a session.\nconst sessionId = Date.now();\nlet userId: null | string = null;\n\nconst getUserId = () => {\n  if (null === userId) {\n    if (null === localStorage.getItem('user_id')) {\n      userId = uuidv4();\n      localStorage.setItem('user_id', userId);\n    } else {\n      userId = localStorage.getItem('user_id');\n    }\n  }\n\n  return userId;\n};\n\nconst sendError = (type: string, error: Error) => {\n  console.error(type, error);\n  sendEvent(UserEvent.ErrorOccured, {type: type, error});\n};\n\nconst sendEvent = async (type: string, event: any = {}) => {\n  if ('development' === process.env.NODE_ENV) return;\n\n  try {\n    await fetch(AMPLITUDE_URL, {\n      method: 'POST',\n      mode: 'cors',\n      cache: 'no-cache',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        api_key: process.env.REACT_APP_ANALYTICS_API_KEY,\n        events: [\n          {\n            user_id: getUserId(),\n            session_id: sessionId,\n            device_id: getUserId(),\n            event_type: type,\n            time: Date.now(),\n            event_properties: event,\n            app_version: process.env.REACT_APP_VERSION,\n          },\n        ],\n      }),\n    });\n  } catch {}\n};\n\nexport {sendEvent, sendError, UserEvent};\n","import SuperGif from 'libgif';\n\nexport enum Sample {\n  Trim = 'trim',\n  Sample = 'sample',\n}\n\nexport type Frame = {data: ImageData; delay: number};\nexport type GIF = Frame[];\nexport type Configuration = {\n  mode: Sample;\n  start: number;\n  end: number;\n};\n\nconst blockedProviders = ['media.gifs.nl'];\n\nconst getBase64 = async (file: File): Promise<string> => {\n  return new Promise((resolve) => {\n    var reader = new FileReader();\n\n    reader.onload = function (event: any) {\n      resolve(event.target.result);\n    };\n\n    reader.readAsDataURL(file);\n  });\n};\nconst getImage = async (url: string): Promise<HTMLImageElement> => {\n  return new Promise((resolve) => {\n    var image = new Image();\n\n    image.onload = function (event: any) {\n      resolve(image);\n    };\n\n    image.src = url;\n  });\n};\n\nconst getGifLength = (gif: GIF) => (0 === gif.length ? 0 : gif.length * gif[0].delay * 10);\nconst getGifStepLength = (gif: GIF) => (0 === gif.length ? 0 : gif[0].delay * 10);\n\nconst getDataUrl = async (url: string): Promise<string> => {\n  return new Promise((resolve, reject) => {\n    var xhr = new XMLHttpRequest();\n    xhr.onload = function () {\n      if ('image/gif' !== xhr.response.type) {\n        reject(`Url \"${url}\" does not lead to a gif file`);\n      }\n\n      var reader = new FileReader();\n      reader.onloadend = function () {\n        if (null === reader.result) {\n          reject(`Cannot read file for url \"${url}\"`);\n        }\n\n        resolve(reader.result as string);\n      };\n      reader.readAsDataURL(xhr.response);\n    };\n    xhr.onerror = (error) => {\n      if (blockedProviders.some((provider) => -1 !== url.indexOf(provider))) {\n        reject(\n          `The provider \"${blockedProviders.find(\n            (provider) => -1 !== url.indexOf(provider)\n          )}\" does not allow to download gifs from external tools.\n          It's not ideal but you can download the gif yourself and import it using the file section below ðŸ˜‰`\n        );\n      } else {\n        reject(\n          `Cannot fetch url \"${url}\". It's likely to be related a right limitation coming from\n          the image provider. Try to download it yourself and import it using the file section below ðŸ˜‰`\n        );\n      }\n    };\n    xhr.open('GET', url);\n    xhr.responseType = 'blob';\n    xhr.send();\n  });\n};\n\nconst getSuperGif = async (image: HTMLImageElement): Promise<any> => {\n  return new Promise((resolve) => {\n    var superGif = new SuperGif({gif: image, auto_play: false});\n    superGif.load(() => {\n      resolve(superGif);\n    });\n  });\n};\n\nconst getGif = async (urlData: string): Promise<GIF> => {\n  const image = await getImage(urlData);\n  const parent = document.createElement('div');\n  parent.appendChild(image);\n\n  return (await getSuperGif(image)).get_frames();\n};\n\nexport {getGif, getImage, getBase64, getDataUrl, getGifLength, getGifStepLength};\n","import styled from 'styled-components';\n\nconst Container = styled.div<{isVisible: boolean}>`\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(0, 0, 0, 0.3);\n  opacity: ${(props) => (props.isVisible ? 1 : 0)};\n\n  transition: opacity 0.5s ease-in-out;\n`;\nconst Mask = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  opacity: 0;\n`;\n\nconst Modal = styled.div`\n  z-index: 9;\n  width: ${(props) => props.theme.addModal.windowSize}px;\n  height: ${(props) => props.theme.addModal.windowSize + props.theme.addModal.spacing}px;\n  background: ${(props) => props.theme.color.white};\n  overflow: hidden;\n  border-radius: 5px;\n  box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);\n`;\n\nconst Header = styled.div`\n  height: ${(props) => props.theme.addModal.spacing}px;\n  width: ${(props) => props.theme.addModal.windowSize}px;\n  background: ${(props) => props.theme.color.grey};\n  color: white;\n  position: relative;\n  z-index: 10;\n`;\n\nconst Dismiss = styled.div`\n  position: absolute;\n  left: 0;\n  top: 0;\n  height: 100%;\n  line-height: ${(props) => props.theme.addModal.spacing}px;\n  width: ${(props) => props.theme.addModal.spacing}px;\n  text-align: center;\n  font-size: 30px;\n  font-weight: 100;\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst Title = styled.div`\n  width: 100%;\n  height: 100%;\n  line-height: ${(props) => props.theme.addModal.spacing}px;\n  text-align: center;\n  font-size: 25px;\n  font-weight: 200;\n`;\n\nexport {Container, Mask, Modal, Header, Dismiss, Title};\n","import {useState} from 'react';\n\nconst useBooleanState = (defaultValue: boolean): [boolean, () => void, () => void] => {\n  const [value, setValue] = useState(defaultValue);\n\n  return [value, () => setValue(true), () => setValue(false)];\n};\n\nexport {useBooleanState};\n","import {GIF, Sample, Configuration, Frame} from './gif';\n\nconst FRAME_WIDTH = 1014;\nconst FRAME_HEIGHT = 468;\nconst ANIMATION_LENGTH = 2000;\n\nconst addImageToCanvas = (context: CanvasRenderingContext2D, imageData: ImageData) => {\n  const croppedWidth = imageData.width;\n  const croppedHeight = (imageData.width / FRAME_WIDTH) * FRAME_HEIGHT;\n  const left = 0;\n  const top = (imageData.height - croppedHeight) / 2;\n\n  context.putImageData(imageData, 0, -top, left, top, croppedWidth, croppedHeight);\n};\n\nconst drawImage = (canvas: HTMLCanvasElement, imageData: ImageData) => {\n  const context = canvas.getContext('2d');\n  if (null === context) return;\n\n  addImageToCanvas(context, imageData);\n  context.drawImage(canvas, 0, 0, FRAME_WIDTH, FRAME_HEIGHT);\n};\n\nconst getAnimate = (configuration: Configuration) =>\n  configuration.mode === Sample.Trim ? getTrimedFrames : getSampledFrames;\n\nconst getTrimedFrames = (gif: GIF) => {\n  const frameCount = Math.floor(ANIMATION_LENGTH / (gif[0].delay * 10));\n\n  return [...new Array(30)].map((_value: any, index: number) =>\n    getFrame(frameCount >= gif.length ? gif.length : frameCount, index)\n  );\n};\nconst getSampledFrames = (gif: GIF) => {\n  return [...new Array(30)].map((_value: any, index: number) => getFrame(gif.length, index));\n};\n\nconst filterGif = (gif: GIF, start: number, end: number): GIF => {\n  let previousPosition = 0;\n  return gif.filter((frame: Frame) => {\n    const position = previousPosition + frame.delay * 10;\n\n    previousPosition = position;\n    return position >= start && position <= end;\n  });\n};\n\nconst animate = (canvas: HTMLCanvasElement, gif: GIF, configuration: Configuration): number => {\n  let cpt = 0;\n  const trimedGif = filterGif(gif, configuration.start, configuration.end);\n  const frames = getAnimate(configuration)(trimedGif);\n\n  return setInterval(() => {\n    const imageData = trimedGif[frames[cpt % 30]].data;\n    drawImage(canvas, imageData);\n    cpt++;\n  }, ANIMATION_LENGTH / 30);\n};\n\nconst scaleImage = (canvas: HTMLCanvasElement, gif: GIF) => {\n  const scale = FRAME_WIDTH / gif[0].data.width;\n\n  (canvas.getContext('2d') as any).scale(scale, scale);\n};\n\nconst clearCanvas = (canvas: HTMLCanvasElement) => {\n  (canvas.getContext('2d') as any).clearRect(0, 0, FRAME_WIDTH, FRAME_HEIGHT);\n};\n\nconst getFrame = (totalFrames: number, frameNumber: number) => {\n  const frameStep = totalFrames / 30;\n\n  return Math.floor(frameNumber * frameStep);\n};\n\nconst getImages = (gif: GIF, configuration: Configuration): ImageData[] => {\n  const trimedGif = filterGif(gif, configuration.start, configuration.end);\n  const frames = getAnimate(configuration)(trimedGif);\n\n  return frames.map((key: number) => {\n    const canvas = document.createElement('canvas');\n    canvas.width = FRAME_WIDTH;\n    canvas.height = FRAME_HEIGHT;\n    const imageData = trimedGif[key].data;\n    const scale = FRAME_WIDTH / imageData.width;\n\n    const context = canvas.getContext('2d');\n    if (null === context) throw Error('Cannot get context');\n    addImageToCanvas(context, imageData);\n    context.scale(scale, scale);\n    context.drawImage(canvas, 0, 0);\n\n    return context.getImageData(0, 0, FRAME_WIDTH, FRAME_HEIGHT);\n  });\n};\n\nconst getOffsetX = (index: number): number => 5 + (FRAME_WIDTH + 10) * (index % 4);\nconst getOffsetY = (index: number): number => 22 + (FRAME_HEIGHT + 44) * Math.floor(index / 4);\n\nconst generateSprite = async (images: ImageData[]): Promise<string> => {\n  const canvas = document.createElement('canvas');\n  canvas.width = 4096;\n  canvas.height = 4096;\n  const context = canvas.getContext('2d');\n  if (null === context) throw Error('Cannot create canvas');\n\n  for (let key in images) {\n    context.putImageData(images[key], getOffsetX(key as any), getOffsetY(key as any));\n  }\n\n  context.drawImage(canvas, 0, 0);\n\n  return canvas.toDataURL('image/png');\n};\n\nexport {\n  addImageToCanvas,\n  scaleImage,\n  animate,\n  getAnimate,\n  generateSprite,\n  getImages,\n  clearCanvas,\n  FRAME_WIDTH,\n  FRAME_HEIGHT,\n};\n","import {createContext} from 'react';\n\nconst LoadingContext = createContext<[boolean, (newValue: boolean) => void]>([false, () => {}]);\n\nexport {LoadingContext};\n","import styled, {css} from 'styled-components';\n\nconst Back = styled.div<{vertical: boolean; leading?: boolean}>`\n  position: absolute;\n  ${({leading = true}) =>\n    leading\n      ? css`\n          top: 0;\n        `\n      : css`\n          bottom: 0;\n        `}\n\n  ${(props) =>\n    props.vertical\n      ? css`\n          right: ${(props) => props.theme.addModal.spacing}px;\n          transform: rotate(-90deg);\n          transform-origin: ${(props) => props.theme.addModal.windowSize}px 0;\n        `\n      : css`\n          left: 0;\n        `}\n\n  height: ${(props) => props.theme.addModal.spacing}px;\n  width: ${(props) => props.theme.addModal.windowSize}px;\n  text-align: center;\n  line-height: ${(props) => props.theme.addModal.spacing}px;\n  font-size: 20px;\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nexport {Back};\n","import {useCallback, useEffect} from 'react';\nimport {Key} from '../tools/key';\n\nconst useShortcut = (key: Key, callback: () => void) => {\n  const memoizedCallback = useCallback((event: KeyboardEvent) => (key === event.code ? callback() : null), [\n    key,\n    callback,\n  ]);\n\n  useEffect(() => {\n    document.addEventListener('keydown', memoizedCallback);\n    return () => document.removeEventListener('keydown', memoizedCallback);\n  }, [memoizedCallback]);\n};\n\nexport {useShortcut};\n","enum Key {\n  Space = ' ',\n  Enter = 'Enter',\n  NumpadEnter = 'NumpadEnter',\n  Backspace = 'Backspace',\n  Escape = 'Escape',\n  ArrowLeft = 'ArrowLeft',\n  ArrowRight = 'ArrowRight',\n}\n\nexport {Key};\n","import React, {useRef, useEffect} from 'react';\nimport styled from 'styled-components';\nimport {GIF, Configuration} from '../tools/gif';\nimport {scaleImage, FRAME_WIDTH, FRAME_HEIGHT, animate} from '../tools/canvas';\n\nconst Canvas = styled.canvas<{cssWidth: number}>`\n  width: ${(props) => props.cssWidth}px;\n  height: ${(props) => (props.cssWidth / FRAME_WIDTH) * FRAME_HEIGHT}px;\n`;\n\nconst Player = ({gif, width, configuration}: {gif: GIF; width: number; configuration: Configuration}) => {\n  const canvasRef = useRef(null);\n\n  useEffect(() => {\n    if (null !== canvasRef && null !== canvasRef.current) {\n      scaleImage(canvasRef.current as any, gif);\n    }\n  }, [gif]);\n\n  useEffect(() => {\n    if (null !== canvasRef && null !== canvasRef.current) {\n      const timer = animate(canvasRef.current as any, gif, configuration);\n\n      return () => {\n        clearInterval(timer);\n      };\n    }\n  }, [gif, configuration]);\n\n  return <Canvas ref={canvasRef} width={FRAME_WIDTH} height={FRAME_HEIGHT} cssWidth={width}></Canvas>;\n};\n\nexport {Player};\n","import React, {useState, useEffect, useCallback, useContext} from 'react';\nimport {GIF, Configuration} from '../../tools/gif';\nimport styled from 'styled-components';\nimport {SourceSelector} from './Adder/SourceSelector';\nimport {LoopConfigurator} from './Adder/LoopConfigurator';\nimport {SpriteSelector} from './Adder/SpriteSelector';\nimport {Loop} from '../../model/loop';\nimport {useBooleanState} from '../../hooks/boolean';\nimport {sendEvent, UserEvent} from '../../tools/analytics';\nimport {Container, Modal, Header, Dismiss, Title, Mask} from '../Modal';\nimport {useShortcut} from '../../hooks/shortcut';\nimport {Key} from '../../tools/key';\nimport {Loading} from '../Loading';\nimport {LoadingContext} from '../../context/loading';\n\nconst Scroller = styled.div<{level: number}>`\n  width: ${(props) => props.theme.addModal.windowSize * 3}px;\n  display: flex;\n  transform: translate3d(\n    -${(props) => props.level * (props.theme.addModal.windowSize - props.theme.addModal.spacing)}px,\n    0,\n    0\n  );\n  transition: transform 0.5s ease-in-out;\n`;\n\nconst getLevel = (gif: GIF, configuration: Configuration | null): number => {\n  if (null !== configuration) {\n    return 2;\n  }\n  if (0 !== gif.length) {\n    return 1;\n  }\n\n  return 0;\n};\n\nconst Adder = ({\n  initialSprite = null,\n  onLoopAdd,\n  dismissModal,\n}: {\n  initialSprite?: number | null;\n  onLoopAdd: (loop: Loop) => void;\n  dismissModal: () => void;\n}) => {\n  const [gif, setGif] = useState<GIF>([]);\n  const [configuration, setConfiguration] = useState<Configuration | null>(null);\n  const [sprite, setSprite] = useState<number | null>(initialSprite);\n  const [isVisible, show] = useBooleanState(false);\n  const [loading] = useContext(LoadingContext);\n\n  useEffect(() => {\n    setImmediate(() => show());\n    // eslint-disable-next-line\n  }, []);\n\n  useEffect(() => {\n    if (0 !== gif.length && null !== configuration && null !== sprite) {\n      onLoopAdd({\n        gif,\n        configuration,\n        sprite,\n      });\n    }\n  }, [gif, configuration, sprite, onLoopAdd]);\n\n  const dismiss = useCallback(() => {\n    if (null !== configuration) {\n      sendEvent(UserEvent.CancelAdd, {from: 'sprite'});\n    } else if (0 !== gif.length) {\n      sendEvent(UserEvent.CancelAdd, {from: 'configure'});\n    } else {\n      sendEvent(UserEvent.CancelAdd, {from: 'start'});\n    }\n\n    dismissModal();\n  }, [dismissModal, configuration, gif]);\n\n  useShortcut(Key.Escape, dismiss);\n\n  return (\n    <Container isVisible={isVisible}>\n      <Mask onClick={dismiss} />\n      <Modal>\n        <Header>\n          <Dismiss onClick={dismiss}>X</Dismiss>\n          <Title>Add a loop</Title>\n          <Loading isLoading={loading} />\n        </Header>\n        <Scroller level={getLevel(gif, configuration)}>\n          <SourceSelector\n            previous={0 !== gif.length}\n            onGifSelected={(newGif: GIF) => {\n              setGif(newGif);\n            }}\n          />\n          <LoopConfigurator\n            previous={null !== configuration}\n            gif={gif}\n            onLoopConfirmation={(configuration) => {\n              setConfiguration(configuration);\n            }}\n          />\n          <SpriteSelector\n            onSpriteConfirmation={(sprite: number) => {\n              setSprite(sprite);\n            }}\n          />\n        </Scroller>\n      </Modal>\n    </Container>\n  );\n};\n\nexport {Adder};\n","import React from 'react';\nimport styled from 'styled-components';\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  width: ${(props) => props.theme.addModal.windowSize - props.theme.addModal.spacing}px;\n  height: ${(props) => props.theme.addModal.windowSize}px;\n  padding: ${(props) => props.theme.addModal.spacing}px;\n  background: ${(props) => props.theme.color.black};\n  box-sizing: border-box;\n  justify-content: center;\n  display: flex;\n`;\n\nconst Grid = styled.div`\n  display: grid;\n  grid-gap: 10px;\n  grid-template-columns: repeat(auto-fill, minmax(95px, 1fr));\n`;\n\nconst Sprite = styled.div`\n  width: 95px;\n  margin-right: 10px;\n  height: 44px;\n  background: ${(props) => props.theme.color.white};\n  line-height: 44px;\n  text-align: center;\n  font-weight: 100;\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst SpriteSelector = ({onSpriteConfirmation}: {onSpriteConfirmation: (sprite: number) => void}) => {\n  return (\n    <Container>\n      <Grid>\n        {[...new Array(14)].map((_content, index: number) => (\n          <Sprite\n            key={index}\n            onClick={() => {\n              onSpriteConfirmation(index);\n            }}\n          >\n            {index + 1}\n          </Sprite>\n        ))}\n      </Grid>\n    </Container>\n  );\n};\n\nexport {SpriteSelector};\n","import React from 'react';\nimport styled from 'styled-components';\n\nconst Container = styled.div`\n  position: absolute;\n  height: 100%;\n  right: 0;\n  top: 0;\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n`;\n\nconst Bar = styled.div`\n  width: 50px;\n  height: 20px;\n  border-radius: 10px;\n  margin-right: 20px;\n  overflow: hidden;\n  border: 1px solid ${(props) => props.theme.color.white};\n`;\n\nconst Progress = styled.div`\n  @keyframes moveIt {\n    from {\n      background-position: bottom left;\n    }\n    to {\n      background-position: top right;\n    }\n  }\n\n  height: 100%;\n  width: 70%;\n\n  background: repeating-linear-gradient(\n    120deg,\n    ${(props) => props.theme.color.lightGrey},\n    ${(props) => props.theme.color.lightGrey} 5px,\n    ${(props) => props.theme.color.white} 5px,\n    ${(props) => props.theme.color.white} 6px\n  );\n  background-size: 250px;\n  animation: moveIt 10s linear infinite;\n`;\n\nconst Loading = ({isLoading}: {isLoading: boolean}) => {\n  return (\n    <Container>\n      {isLoading && (\n        <Bar>\n          <Progress />\n        </Bar>\n      )}\n    </Container>\n  );\n};\n\nexport {Loading};\n","import React, {useEffect} from 'react';\nimport {useBooleanState} from '../hooks/boolean';\nimport {Container, Modal, Header, Dismiss, Title, Mask} from './Modal';\nimport styled from 'styled-components';\nimport {useShortcut} from '../hooks/shortcut';\nimport {Key} from '../tools/key';\n\nconst Content = styled.div`\n  padding: 30px 50px;\n  line-height: 23px;\n`;\n\nconst Version = styled.div`\n  text-align: center;\n  font-size: 11px;\n`;\n\nconst Wtf = ({dismissModal}: {dismissModal: () => void}) => {\n  const [isVisible, show] = useBooleanState(false);\n\n  useEffect(() => {\n    setImmediate(() => show());\n  }, [show]);\n\n  useShortcut(Key.Escape, dismissModal);\n\n  return (\n    <Container isVisible={isVisible}>\n      <Mask onClick={dismissModal} />\n      <Modal>\n        <Header>\n          <Dismiss onClick={dismissModal}>X</Dismiss>\n          <Title>What the **** is this?</Title>\n        </Header>\n        <Content>\n          <h2>Hey! Nice to meet you, glad you asked!</h2>\n          <p>\n            This web application is here to ease the generation of sprites for the{' '}\n            <a href=\"https://www.synthpaks.com/products/gif-looper-template-project-beta\">awesome gif looper</a>. <br />\n          </p>\n          <h2>How it works?</h2>\n          <div>\n            <ul>\n              <li>Select one of the 14 slots or click on the \"Add\" button</li>\n              <li>Select a GIF (from an URL or a file)</li>\n              <li>\n                Once you have filled all of the 14 slots (or before if you don't wan't to use them all), click on the\n                download button.\n              </li>\n            </ul>\n            This will generate your sprites in the expected format.\n          </div>\n          <p>\n            For the rest of the process, you can refer to the official documentation of{' '}\n            <a href=\"https://www.synthpaks.com/products/gif-looper-template-project-beta\">gif looper</a>.\n          </p>\n          <h2>Well, that's nice, but it doesn't seems to work</h2>\n          <p>\n            Wow, I'm really sorry to hear that, I hope that you didn't loose any work. Don't hesistate to open an issue{' '}\n            <a href=\"https://github.com/juliensnz/opz-gif/issues\">here</a> or send me a{' '}\n            <a href=\"https://twitter.com/juliensnz\">tweet</a> to see if I can fix it. Or even better: as this is an{' '}\n            <a href=\"https://github.com/juliensnz/opz-gif\">open source project</a>, you maybe can fix it yourself!\n          </p>\n          <Version>v{process.env.REACT_APP_VERSION}</Version>\n        </Content>\n      </Modal>\n    </Container>\n  );\n};\n\nexport {Wtf};\n","import React, {useEffect} from 'react';\nimport {useBooleanState} from '../hooks/boolean';\nimport {Container, Modal, Header, Dismiss, Title, Mask} from './Modal';\nimport styled from 'styled-components';\nimport {useShortcut} from '../hooks/shortcut';\nimport {Key} from '../tools/key';\n\nconst Content = styled.div`\n  padding: 20px 50px;\n  line-height: 23px;\n`;\nconst Donate = styled.input`\n  width: 110px;\n`;\nconst Form = styled.form`\n  display: flex;\n  justify-content: center;\n`;\n\nconst Like = ({dismissModal}: {dismissModal: () => void}) => {\n  const [isVisible, show] = useBooleanState(false);\n\n  useEffect(() => {\n    setImmediate(() => show());\n  }, [show]);\n  useShortcut(Key.Escape, dismissModal);\n\n  return (\n    <Container isVisible={isVisible}>\n      <Mask onClick={dismissModal} />\n      <Modal>\n        <Header>\n          <Dismiss\n            onClick={() => {\n              dismissModal();\n            }}\n          >\n            X\n          </Dismiss>\n          <Title>I like it!</Title>\n        </Header>\n        <Content>\n          <p>Really nice of you, I'm glad you enjoy it :)</p>\n          <h2>But why dude?</h2>\n          <p>\n            I'm a big fan of my OP-Z and wanted to play with the Motion track a bit. I found the{' '}\n            <a href=\"https://www.synthpaks.com/products/gif-looper-template-project-beta\">gif looper</a> project but\n            didn't want to generate sprites by hand. So here is why.\n          </p>\n          <h2>Is it free?</h2>\n          <p>\n            Yes! This project is <a href=\"https://github.com/juliensnz/opz-gif\">open source</a>, you can use this\n            project for free, enjoy it as much as you want and even{' '}\n            <a href=\"https://support.google.com/chrome/answer/9658361?co=GENIE.Platform%3DDesktop&hl=en\">\n              install it locally\n            </a>{' '}\n            to use it offline.\n          </p>\n          <h2>How can I help?</h2>\n          <p>\n            As this project is <a href=\"https://github.com/juliensnz/opz-gif\">open source</a>, you can make suggestions\n            for improvement <a href=\"https://github.com/juliensnz/opz-gif/issues\">here</a> or even{' '}\n            <a href=\"https://github.com/juliensnz/opz-gif\">contribute to the project</a>.\n            <br />\n            <br />\n            If you still want to support me and my work, you can make a donation using the button down bellow.\n          </p>\n          <Form action=\"https://www.paypal.com/cgi-bin/webscr\" method=\"post\" target=\"_top\">\n            <input type=\"hidden\" name=\"cmd\" value=\"_donations\" />\n            <input type=\"hidden\" name=\"business\" value=\"KWM3S8MMH8BNU\" />\n            <input type=\"hidden\" name=\"currency_code\" value=\"EUR\" />\n            <Donate\n              type=\"image\"\n              src=\"https://juliensnz.github.io/opz-gif/donate.png\"\n              name=\"submit\"\n              title=\"PayPal - The safer, easier way to pay online!\"\n              alt=\"Donate with PayPal button\"\n            />\n            <img alt=\"\" src=\"https://www.paypal.com/en_FR/i/scr/pixel.gif\" width=\"1\" height=\"1\" />\n          </Form>\n        </Content>\n      </Modal>\n    </Container>\n  );\n};\n\nexport {Like};\n","import {useRef, useEffect} from 'react';\n\nconst useMounted = (beforeUnmount: () => void = () => {}): (() => boolean) => {\n  const isMountedRef = useRef(true);\n  useEffect(() => {\n    return () => {\n      beforeUnmount();\n      isMountedRef.current = false;\n    };\n    // eslint-disable-next-line\n  }, []);\n\n  return () => isMountedRef.current;\n};\n\nexport {useMounted};\n","import React, {ChangeEvent, useState, useRef, useEffect, KeyboardEvent, useCallback, useContext} from 'react';\nimport styled from 'styled-components';\nimport {getDataUrl, getGif, GIF} from '../../../../tools/gif';\nimport {Back} from '../../../Style/Back';\nimport {Source} from '../SourceSelector';\nimport {useAutoFocus} from '../../../../hooks/focus';\nimport {sendEvent, UserEvent, sendError} from '../../../../tools/analytics';\nimport {LoadingContext} from '../../../../context/loading';\nimport {useMounted} from '../../../../hooks/mounted';\n\nconst Container = styled.div<{selected: boolean; previous: boolean}>`\n  background-color: ${(props) => props.theme.color.yellow};\n  width: ${(props) => props.theme.addModal.windowSize}px;\n  height: ${(props) =>\n    props.selected\n      ? props.theme.addModal.windowSize - (props.previous ? 0 : props.theme.addModal.spacing)\n      : props.theme.addModal.windowSize / props.theme.addModal.sourceCount}px;\n  transition: height 0.5s ease-in-out;\n  flex-direction: column;\n  position: relative;\n`;\n\nconst Button = styled.div`\n  width: ${(props) => props.theme.addModal.windowSize}px;\n  height: ${(props) => props.theme.addModal.windowSize / props.theme.addModal.sourceCount}px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  font-size: 30px;\n  font-weight: 200;\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst Form = styled.div<{visible: boolean}>`\n  display: flex;\n  flex-direction: column;\n  padding: 0 60px;\n  opacity: ${(props) => (props.visible ? 1 : 0)};\n  height: ${(props) => (props.visible ? props.theme.addModal.windowSize / props.theme.addModal.sourceCount : 0)};\n  transition: opacity 0.5s ease-in-out;\n`;\n\nconst Input = styled.input`\n  margin: 0 10px;\n  padding: 10px 5px;\n  font-size: 20px;\n  background: transparent;\n  border: 1px solid rgba(0, 0, 0, 0.3);\n`;\nconst Submit = styled.span`\n  background: ${(props) => props.theme.color.white};\n  color: black;\n  margin: 10px 10px;\n  padding: 10px 5px;\n  font-size: 20px;\n  text-align: center;\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\nconst ErrorDisplay = styled.span`\n  color: ${(props) => props.theme.color.red};\n  margin: 0 10px 10px 10px;\n  padding: 0 5px 10px 5px;\n  font-size: 15px;\n  text-align: left;\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst UrlSource = ({\n  selected,\n  previous,\n  onSelected,\n  onGifSelected,\n}: {\n  selected: Source | null;\n  previous: boolean;\n  onSelected: () => void;\n  onGifSelected: (gif: GIF) => void;\n}) => {\n  const [url, setUrl] = useState('');\n  const [loading, setLoading] = useContext(LoadingContext);\n  const isMounted = useMounted(() => setLoading(false));\n  const [error, setError] = useState<string | null>(null);\n\n  const urlRef = useRef<HTMLInputElement>(null);\n  const setFocus = useAutoFocus(urlRef);\n  useEffect(() => {\n    if (Source.Url === selected) {\n      setFocus();\n    }\n\n    if (null === selected) {\n      setTimeout(() => setUrl(''), 500);\n    }\n  }, [selected, previous, setFocus]);\n\n  const submit = useCallback(async () => {\n    if (true === loading) return;\n    setLoading(true);\n    setError(null);\n\n    try {\n      const gifData = await getDataUrl(url);\n      const newGif = await getGif(gifData);\n\n      if (!isMounted()) return;\n      setLoading(false);\n      sendEvent(UserEvent.GifSelected, {type: 'url'});\n      onGifSelected(newGif);\n    } catch (error) {\n      sendError('cannot_generate_gif_from_url', error);\n      setError(`Error: ${error}`);\n\n      if (!isMounted()) return;\n      setLoading(false);\n    }\n  }, [url, onGifSelected, setLoading, loading, isMounted]);\n\n  return (\n    <Container selected={Source.Url === selected} previous={previous}>\n      <Button onClick={() => Source.Url !== selected && onSelected()}>Url</Button>\n      <Form visible={Source.Url === selected}>\n        <Input\n          ref={urlRef}\n          placeholder=\"Your GIF url\"\n          type=\"text\"\n          onChange={async (event: ChangeEvent<HTMLInputElement>) => {\n            setUrl(event.currentTarget.value);\n          }}\n          onKeyPress={(event: KeyboardEvent<HTMLInputElement>) => {\n            if ('Enter' === event.key) {\n              submit();\n            }\n          }}\n          value={url}\n        />\n        <Submit onClick={submit}>Confirm</Submit>\n        {null !== error && <ErrorDisplay>{error}</ErrorDisplay>}\n      </Form>\n      {previous && (\n        <Back vertical={true} onClick={() => onGifSelected([])}>\n          Back\n        </Back>\n      )}\n      {null !== selected && Source.Url !== selected && (\n        <Back vertical={false} leading={false} onClick={() => onSelected()}>\n          Back\n        </Back>\n      )}\n    </Container>\n  );\n};\n\nexport {UrlSource};\n","import {RefObject, useCallback, useEffect} from 'react';\n\nconst useAutoFocus = (ref: RefObject<HTMLInputElement>): (() => void) => {\n  const focus = useCallback(() => {\n    if (ref.current !== null) ref.current.focus();\n  }, [ref]);\n\n  useEffect(focus, []);\n\n  return focus;\n};\n\nexport {useAutoFocus};\n","import React, {ChangeEvent, useContext, useCallback, useState} from 'react';\nimport styled from 'styled-components';\nimport {GIF, getBase64, getGif} from '../../../../tools/gif';\nimport {Back} from '../../../Style/Back';\nimport {Source} from '../SourceSelector';\nimport {sendEvent, UserEvent, sendError} from '../../../../tools/analytics';\nimport {LoadingContext} from '../../../../context/loading';\nimport {useMounted} from '../../../../hooks/mounted';\n\nconst WINDOW_SIZE = 600;\nconst Container = styled.div<{selected: boolean; previous: boolean}>`\n  background-color: ${(props) => props.theme.color.blue};\n  width: ${WINDOW_SIZE}px;\n  height: ${(props) =>\n    props.selected\n      ? props.theme.addModal.windowSize - (props.previous ? 0 : props.theme.addModal.spacing)\n      : props.theme.addModal.windowSize / props.theme.addModal.sourceCount}px;\n  transition: height 0.5s ease-in-out;\n  position: relative;\n`;\nconst Button = styled.div`\n  width: ${(props) => props.theme.addModal.windowSize}px;\n  height: ${(props) => props.theme.addModal.windowSize / props.theme.addModal.sourceCount}px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  font-size: 30px;\n  font-weight: 200;\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst DropZone = styled.div<{visible: boolean}>`\n  width: ${(props) => props.theme.addModal.windowSize}px;\n  opacity: ${(props) => (props.visible ? 1 : 0)};\n  height: ${(props) => (props.visible ? props.theme.addModal.windowSize / props.theme.addModal.sourceCount : 0)}px;\n  transition: opacity 0.5s ease-in-out, transform 0.2s ease-in-out;\n  position: relative;\n\n  &:hover {\n    cursor: pointer;\n    transform: scale(1.02);\n  }\n`;\n\nconst Explanation = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: calc(100% - ${(props) => props.theme.addModal.spacing * 2}px);\n  height: calc(100% - ${(props) => props.theme.addModal.spacing * 2}px);\n  background-image: url(\"data:image/svg+xml,%3csvg width='100%25' height='100%25' xmlns='http://www.w3.org/2000/svg'%3e%3crect width='100%25' height='100%25' fill='none' rx='10' ry='10' stroke='%23E9B13DFF' stroke-width='4' stroke-dasharray='6%2c 14' stroke-dashoffset='0' stroke-linecap='square'/%3e%3c/svg%3e\");\n  border-radius: 10px;\n  margin: 0 ${(props) => props.theme.addModal.spacing}px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 20px;\n  font-weight: 200;\n  padding: 20px;\n  flex-direction: column;\n  box-sizing: border-box;\n`;\n\nconst ErrorDisplay = styled.span`\n  color: ${(props) => props.theme.color.white};\n  text-align: center;\n  margin-top: 20px;\n`;\nconst Input = styled.input`\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  opacity: 0;\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst FileSource = ({\n  selected,\n  previous,\n  onSelected,\n  onGifSelected,\n}: {\n  selected: Source | null;\n  previous: boolean;\n  onSelected: () => void;\n  onGifSelected: (gif: GIF) => void;\n}) => {\n  const [loading, setLoading] = useContext(LoadingContext);\n  const isMounted = useMounted(() => setLoading(false));\n  const [error, setError] = useState<string | null>(null);\n\n  const submit = useCallback(\n    async (event: ChangeEvent<HTMLInputElement>) => {\n      if (true === loading) return;\n      if (null === event.target.files) return;\n      if ('image/gif' !== event.target.files[0].type) {\n        const error = new Error(\n          `File type \"${event.target.files[0].type}\" are not supported yet. Only .gif files are supported for now.`\n        );\n        sendError('cannot_generate_gif_from_file', error);\n        setError(`Error: ${error.message}`);\n        return;\n      }\n      setLoading(true);\n\n      try {\n        const gifData = await getBase64(event.target.files[0]);\n        const newGif = await getGif(gifData);\n\n        if (!isMounted()) return;\n        setLoading(false);\n        sendEvent(UserEvent.GifSelected, {type: 'file'});\n        onGifSelected(newGif);\n      } catch (error) {\n        sendError('cannot_generate_gif_from_file', error);\n        setError(`Error: ${error}`);\n\n        if (!isMounted()) return;\n        setLoading(false);\n      }\n    },\n    [onGifSelected, setLoading, loading, isMounted]\n  );\n\n  return (\n    <Container selected={Source.File === selected} previous={previous}>\n      <Button onClick={() => Source.File !== selected && onSelected()}>File</Button>\n      {null !== selected && Source.File !== selected && (\n        <Back vertical={false} onClick={() => onSelected()}>\n          Back\n        </Back>\n      )}\n      <DropZone visible={Source.File === selected}>\n        <Explanation>\n          <span>Click here or directly drop your file</span>\n          {null !== error && <ErrorDisplay>{error}</ErrorDisplay>}\n        </Explanation>\n\n        <Input type=\"file\" onChange={submit} />\n      </DropZone>\n\n      {previous && (\n        <Back vertical={true} onClick={() => onGifSelected([])}>\n          Back\n        </Back>\n      )}\n    </Container>\n  );\n};\n\nexport {FileSource};\n","import React, {useState} from 'react';\nimport {GIF} from '../../../tools/gif';\nimport styled from 'styled-components';\nimport {UrlSource} from './SourceSelector/UrlSource';\nimport {FileSource} from './SourceSelector/FileSource';\n\nenum Source {\n  Url,\n  File,\n}\n\nconst Container = styled.div<{source: Source | null; previous: boolean}>`\n  width: ${(props) => props.theme.addModal.windowSize}px;\n  overflow: hidden;\n  transform: translate3d(\n    0,\n    -${(props) => (props.source === Source.File ? props.theme.addModal.windowSize / 2 - (!props.previous ? props.theme.addModal.spacing : 0) : 0)}px,\n    0\n  );\n  transition: all 0.5s ease-in-out;\n`;\n\nconst SourceSelector = ({onGifSelected, previous}: {previous: boolean; onGifSelected: (gif: GIF) => void}) => {\n  const [source, setSource] = useState<null | Source>(null);\n\n  return (\n    <Container source={source} previous={previous}>\n      <UrlSource\n        onSelected={() => {\n          setSource(null === source ? Source.Url : null);\n        }}\n        selected={source}\n        previous={previous}\n        onGifSelected={onGifSelected}\n      />\n      <FileSource\n        onSelected={() => {\n          setSource(null === source ? Source.File : null);\n        }}\n        selected={source}\n        previous={previous}\n        onGifSelected={onGifSelected}\n      />\n    </Container>\n  );\n};\n\nexport {SourceSelector, Source};\n","import React, {useState, useEffect, useRef, useCallback} from 'react';\nimport styled from 'styled-components';\nimport {getTimeLabel} from './Cutter';\n\nenum HandlePosition {\n  Start,\n  End,\n}\nconst Grabber = styled.span`\n  width: 10px;\n  height: 20px;\n  border: 1px solid ${(props) => props.theme.color.grey};\n  background: repeating-linear-gradient(\n    120deg,\n    ${(props) => props.theme.color.grey},\n    ${(props) => props.theme.color.grey} 5px,\n    ${(props) => props.theme.color.white} 5px,\n    ${(props) => props.theme.color.white} 6px\n  );\n`;\nconst HandleGrabber = styled.div`\n  display: flex;\n  flex-direction: column;\n  margin-left: 20px;\n  margin-bottom: 18px;\n`;\nconst Pin = styled.div`\n  background: ${(props) => props.theme.color.grey};\n  width: 1px;\n  height: 5px;\n`;\nconst Container = styled.div`\n  display: flex;\n  position: absolute;\n  top: 0;\n  display: flex;\n  align-items: center;\n  ${Grabber} {\n    border-bottom-right-radius: 5px;\n    border-bottom-left-radius: 5px;\n  }\n  &:hover {\n    cursor: grab;\n  }\n  &:active {\n    cursor: grabbing;\n  }\n`;\nconst StartHandle = styled(Container)`\n  ${Grabber} {\n    border-top-right-radius: 5px;\n  }\n  ${HandleGrabber} {\n    align-items: flex-start;\n  }\n`;\nconst EndHandle = styled(Container)`\n  position: relative;\n  ${Grabber} {\n    border-top-left-radius: 5px;\n  }\n  ${HandleGrabber} {\n    align-items: flex-end;\n  }\n`;\nconst HandleTime = styled.span`\n  margin-left: 3px;\n  position: relative;\n  top: -7px;\n`;\n\nconst Handle = ({\n  handlePosition,\n  min,\n  max,\n  value,\n  length,\n  onChange,\n  onEnd,\n}: {\n  handlePosition: HandlePosition;\n  min: number;\n  max: number;\n  value: number;\n  length: number;\n  onChange: (newValue: number) => void;\n  onEnd: () => void;\n}) => {\n  const Element = handlePosition === HandlePosition.Start ? StartHandle : EndHandle;\n  const [parentWidth, setParentWidth] = useState<number>(0);\n  const [currentPosition, setCurrentPosition] = useState<number>((value / length) * parentWidth);\n  useEffect(() => {\n    setCurrentPosition((value / length) * parentWidth);\n  }, [value, parentWidth, length]);\n\n  const [grabberStartX, setGrabberStartX] = useState<number>(0);\n  const [startingPosition, setStartingPosition] = useState<number>(0);\n  const [isDragged, setIsDragged] = useState<boolean>(false);\n\n  const containerRef = useRef(null);\n  useEffect(() => {\n    setIsDragged(false);\n    null !== containerRef.current &&\n      (containerRef.current as any).parentNode &&\n      setParentWidth((containerRef.current as any).parentNode.getBoundingClientRect().width);\n  }, []);\n\n  const mouseUp = useCallback(\n    (event: any) => {\n      event.preventDefault();\n      setIsDragged(false);\n      onEnd();\n    },\n    [onEnd]\n  );\n\n  useEffect(() => {\n    if (isDragged) window.addEventListener('mouseup', mouseUp);\n\n    return () => window.removeEventListener('mouseup', mouseUp);\n  }, [isDragged, onEnd, mouseUp]);\n\n  const mouseDown = useCallback(\n    (event: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n      event.preventDefault();\n      setGrabberStartX(event.clientX);\n      setIsDragged(true);\n      setStartingPosition(Math.round(currentPosition));\n    },\n    [setIsDragged, setGrabberStartX, currentPosition]\n  );\n\n  const mouseMove = useCallback(\n    (event) => {\n      event.preventDefault();\n      if (isDragged) {\n        const newPosition = Math.round(startingPosition + event.clientX - grabberStartX);\n        const newValue = Math.round((newPosition / parentWidth) * length);\n\n        if (newValue > max + 1) {\n          onChange(max);\n          return;\n        } else if (newValue < min - 1) {\n          onChange(min);\n          return;\n        }\n\n        setCurrentPosition(newPosition);\n        onChange(newValue);\n      }\n    },\n    [isDragged, startingPosition, grabberStartX, length, max, min, onChange, parentWidth]\n  );\n\n  return (\n    <Element\n      ref={containerRef}\n      style={{left: `${handlePosition === HandlePosition.Start ? currentPosition - 20 : currentPosition - 32}px`}}\n      onMouseDown={mouseDown}\n      onMouseMove={mouseMove}\n    >\n      <HandleGrabber>\n        <Pin />\n        <Grabber />\n      </HandleGrabber>\n      <HandleTime>{getTimeLabel(value)}</HandleTime>\n    </Element>\n  );\n};\n\nexport {Handle, HandlePosition};\n","import React, {useCallback, useEffect, useState} from 'react';\nimport styled from 'styled-components';\nimport {Sample, GIF, getGifStepLength} from '../../../../tools/gif';\nimport {Handle, HandlePosition} from './Handle';\n\nconst Container = styled.div`\n  width: ${(props) => props.theme.addModal.windowSize - props.theme.addModal.spacing * 3}px;\n`;\n\nconst Timeline = styled.div`\n  width: 100%;\n  display: flex;\n  height: 20px;\n  background-color: ${(props) => props.theme.color.grey};\n`;\n\nconst Timing = styled.div`\n  display: flex;\n  font-size: 12px;\n`;\nconst Spacer = styled.div`\n  flex: 1;\n`;\n\nconst CutBoard = styled.div`\n  position: relative;\n  font-size: 12px;\n`;\n\nconst Start = styled.div`\n  position: relative;\n  width: 40px;\n  left: -20px;\n  text-align: center;\n`;\nconst End = styled.div`\n  position: relative;\n  width: 40px;\n  right: -20px;\n  text-align: center;\n`;\nconst Trim = styled.div`\n  height: 100%;\n`;\nconst TrimStart = styled(Trim)`\n  background: repeating-linear-gradient(\n    120deg,\n    rgba(0, 0, 0, 0.1),\n    rgba(0, 0, 0, 0.1) 5px,\n    ${(props) => props.theme.color.grey} 5px,\n    ${(props) => props.theme.color.grey} 6px\n  );\n`;\n\nconst TrimEnd = styled(Trim)`\n  background: repeating-linear-gradient(\n    120deg,\n    rgba(0, 0, 0, 0.1),\n    rgba(0, 0, 0, 0.1) 5px,\n    ${(props) => props.theme.color.grey} 5px,\n    ${(props) => props.theme.color.grey} 6px\n  );\n  background-position-x: right;\n`;\nconst TrimCenter = styled(Trim)``;\n\ntype CutterProps = {\n  length: number;\n  start: number;\n  end: number;\n  mode: Sample;\n  gif: GIF;\n  onChange: (start: number, end: number) => void;\n};\n\nconst getTimeLabel = (time: number): string => {\n  const label = (Math.round(time / 10) / 100).toString().replace('.', '\"');\n\n  return `${label}${label.includes('\"') ? '' : '\"'}`;\n};\n\nconst Cutter = ({length, start, end, mode, gif, onChange}: CutterProps) => {\n  const [state, setState] = useState({start, end});\n  useEffect(() => {\n    setState({start, end});\n  }, [start, end]);\n\n  const onStartChange = useCallback(\n    (newStart: number) => {\n      Sample.Sample === mode\n        ? setState({...state, start: newStart})\n        : setState({start: newStart, end: newStart + 2000});\n    },\n    [state, mode]\n  );\n  const onEndChange = useCallback(\n    (newEnd: number) => {\n      Sample.Sample === mode ? setState({...state, end: newEnd}) : setState({start: newEnd - 2000, end: newEnd});\n    },\n    [state, mode]\n  );\n  const onEnd = useCallback(() => {\n    onChange(state.start, state.end);\n  }, [state, onChange]);\n\n  return (\n    <Container>\n      <Timing>\n        <Start>{getTimeLabel(0)}</Start>\n        <Spacer />\n        <End>{getTimeLabel(length)}</End>\n      </Timing>\n      <Timeline>\n        <TrimStart style={{width: `${(state.start / length) * 100}%`}} />\n        <TrimCenter style={{width: `${((length - (state.start + length - state.end)) / length) * 100}%`}} />\n        <TrimEnd style={{width: `${((length - state.end) / length) * 100}%`}} />\n      </Timeline>\n      <CutBoard>\n        <Handle\n          value={state.start}\n          handlePosition={HandlePosition.Start}\n          min={0}\n          max={Sample.Sample === mode ? state.end - getGifStepLength(gif) * 3 : length - 2000}\n          length={length}\n          onChange={onStartChange}\n          onEnd={onEnd}\n        />\n        <Handle\n          value={state.end}\n          handlePosition={HandlePosition.End}\n          min={Sample.Sample === mode ? state.start + getGifStepLength(gif) * 3 : 2000}\n          max={length}\n          length={length}\n          onChange={onEndChange}\n          onEnd={onEnd}\n        />\n      </CutBoard>\n    </Container>\n  );\n};\n\nexport {Cutter, getTimeLabel};\n","import React from 'react';\nimport styled, {css} from 'styled-components';\nimport {Sample} from '../../../../tools/gif';\n\nconst Container = styled.div`\n  margin-top: 10px;\n  width: 100%;\n  height: 40px;\n  /* border: 1px solid ${(props) => props.theme.color.grey}; */\n  border-radius: 3px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  /* overflow: hidden; */\n`;\n\nconst Mode = styled.div<{selected: boolean}>`\n  flex: 1;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: ${(props) => props.theme.color.black};\n  border: 1px solid ${(props) => props.theme.color.grey};\n\n  ${(props) =>\n    props.selected\n      ? css`\n          background: ${(props) => props.theme.color.yellow};\n        `\n      : css``};\n\n  &:nth-child(1) {\n    border-bottom-left-radius: 3px;\n    border-top-left-radius: 3px;\n    border-right: none;\n  }\n  &:nth-child(2) {\n    border-bottom-right-radius: 3px;\n    border-top-right-radius: 3px;\n  }\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst SampleModeSelector = ({mode, onChange}: {mode: Sample; onChange: (newMode: Sample) => void}) => {\n  return (\n    <Container>\n      <Mode selected={mode === Sample.Trim} onClick={() => onChange(Sample.Trim)}>\n        Trim\n      </Mode>\n      <Mode selected={mode === Sample.Sample} onClick={() => onChange(Sample.Sample)}>\n        Sample\n      </Mode>\n    </Container>\n  );\n};\n\nexport {SampleModeSelector};\n","import React, {useContext, useState, useEffect, useCallback} from 'react';\nimport styled, {ThemeContext} from 'styled-components';\nimport {GIF, Sample, Configuration, getGifLength} from '../../../tools/gif';\nimport {Player} from '../../Player';\nimport {Back} from '../../Style/Back';\nimport {Cutter} from './LoopConfigurator/Cutter';\nimport {SampleModeSelector} from './LoopConfigurator/SampleModeSelector';\nimport {sendEvent, UserEvent} from '../../../tools/analytics';\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  width: ${(props) => props.theme.addModal.windowSize - props.theme.addModal.spacing}px;\n  height: ${(props) => props.theme.addModal.windowSize}px;\n  padding: ${(props) => props.theme.addModal.spacing}px;\n  background: rgb(208, 208, 208);\n  box-sizing: border-box;\n  justify-content: space-between;\n  position: relative;\n`;\n\nconst Submit = styled.span`\n  background-color: ${(props) => props.theme.color.yellow};\n  color: black;\n  margin: 20px 0;\n  padding: 10px 5px;\n  font-size: 20px;\n  text-align: center;\n  text-transform: uppercase;\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst Configurator = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n\nconst LoopConfigurator = ({\n  gif,\n  onLoopConfirmation,\n  previous,\n}: {\n  gif: GIF;\n  previous: boolean;\n  onLoopConfirmation: (mode: Configuration | null) => void;\n}) => {\n  const theme = useContext(ThemeContext);\n  const [configuration, setConfiguration] = useState({start: 0, end: getGifLength(gif), mode: Sample.Sample});\n  const [tooShort, setTooShort] = useState(false);\n\n  useEffect(() => {\n    if (2000 > getGifLength(gif)) {\n      setConfiguration({start: 0, end: getGifLength(gif), mode: Sample.Sample});\n      setTooShort(true);\n    } else {\n      setConfiguration({start: 0, end: 2000, mode: Sample.Trim});\n      setTooShort(false);\n    }\n  }, [gif]);\n\n  const onModeChange = useCallback(\n    (newMode: Sample) => {\n      const newStartEnd =\n        newMode === Sample.Trim\n          ? {\n              start: newMode === Sample.Trim ? 0 : configuration.start,\n              end: newMode === Sample.Trim ? 2000 : configuration.end,\n            }\n          : {};\n      setConfiguration({\n        ...configuration,\n        mode: newMode,\n        ...newStartEnd,\n      });\n    },\n    [configuration]\n  );\n\n  const onCutChange = useCallback(\n    (start: number, end: number) => {\n      setConfiguration({...configuration, start, end});\n    },\n    [configuration]\n  );\n\n  useEffect(() => {\n    if (\n      !(0 === configuration.start && getGifLength(gif) === configuration.end && configuration.mode === Sample.Sample) &&\n      !(0 === configuration.start && 2000 === configuration.end && configuration.mode === Sample.Trim)\n    )\n      sendEvent(UserEvent.ConfigurationChange, configuration);\n  }, [configuration, gif]);\n\n  return (\n    <Container>\n      {gif.length !== 0 && (\n        <>\n          <Configurator>\n            <Player\n              gif={gif}\n              configuration={configuration}\n              width={theme.addModal.windowSize - theme.addModal.spacing * 3}\n            />\n            {!tooShort && <SampleModeSelector mode={configuration.mode} onChange={onModeChange} />}\n            <Cutter\n              length={getGifLength(gif)}\n              start={configuration.start}\n              end={configuration.end}\n              mode={configuration.mode}\n              gif={gif}\n              onChange={onCutChange}\n            />\n          </Configurator>\n          <Submit\n            onClick={() => {\n              onLoopConfirmation(configuration);\n            }}\n          >\n            Confirm\n          </Submit>\n        </>\n      )}\n      {previous && (\n        <Back vertical={true} onClick={() => onLoopConfirmation(null)}>\n          Back\n        </Back>\n      )}\n    </Container>\n  );\n};\n\nexport {LoopConfigurator};\n","import JSZip from 'jszip';\nimport {generateSprite, getImages} from './canvas';\nimport {Loop} from '../model/loop';\n\nconst generateZip = (loops: Loop[]): Promise<Blob> => {\n  return new Promise(async (resolve) => {\n    const zip = new JSZip();\n    const folder = zip.folder('GIFs');\n    for (const loop of loops) {\n      const sprite = await generateSprite(getImages(loop.gif, loop.configuration));\n      if ('' === sprite) return;\n\n      folder.file(\n        `GIF-Looper-Template-Spritesheet${loop.sprite + 1 < 10 ? '0' : ''}${loop.sprite + 1}.png`,\n        sprite.replace('data:image/png;base64,', ''),\n        {\n          base64: true,\n        }\n      );\n    }\n\n    zip.generateAsync({type: 'blob'}).then(function (content) {\n      resolve(content);\n    });\n  });\n};\n\nexport {generateZip};\n","import React from 'react';\nimport {Loop} from '../model/loop';\nimport styled from 'styled-components';\nimport {Player} from './Player';\n\nconst Container = styled.div`\n  flex: 1;\n  display: flex;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\nconst Grid = styled.div`\n  display: grid;\n  grid-gap: 10px;\n  grid-template-columns: repeat(4, 300px);\n`;\n\nconst Item = styled.div`\n  position: relative;\n  display: flex;\n  justify-content: center;\n  height: 138px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border: 1px solid ${(props) => props.theme.color.lightGrey};\n  border-radius: 3px;\n  font-size: 40px;\n  color: ${(props) => props.theme.color.lightGrey};\n  background: repeating-linear-gradient(\n    120deg,\n    ${(props) => props.theme.color.white},\n    ${(props) => props.theme.color.white} 5px,\n    ${(props) => props.theme.color.lightGrey} 5px,\n    ${(props) => props.theme.color.lightGrey} 6px\n  );\n`;\n\nconst Wtf = styled(Item)`\n  &:hover {\n    cursor: pointer;\n  }\n`;\nconst Like = styled(Item)`\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst Actions = styled.div`\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  background: ${(props) => props.theme.color.red};\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-weight: 100;\n  font-size: 25px;\n  color: ${(props) => props.theme.color.black};\n  opacity: 0;\n  transition: opacity 0.2s ease-in-out;\n  display: flex;\n\n  &:hover {\n    cursor: pointer;\n    opacity: 1;\n  }\n`;\n\nconst Action = styled.div`\n  flex: 1;\n  justify-content: center;\n  align-items: center;\n  display: flex;\n  height: 100%;\n\n  &:hover {\n    background: rgba(0, 0, 0, 0.1);\n  }\n`;\n\nconst Loops = ({\n  loops,\n  onOpenAddLoop,\n  onRemoveLoop,\n  onOpenInfoLoop,\n  onOpenLikeLoop,\n}: {\n  loops: Loop[];\n  onOpenAddLoop: (sprite: number) => void;\n  onRemoveLoop: (sprite: number) => void;\n  onOpenInfoLoop: () => void;\n  onOpenLikeLoop: () => void;\n}) => {\n  const nonEmptyLoops = [...new Array(14)].map((_content, index: number) => {\n    return loops.find((loop) => loop.sprite === index);\n  });\n\n  return (\n    <Container>\n      <Grid>\n        {nonEmptyLoops.map((loop: Loop | undefined, index: number) => (\n          <Item key={index}>\n            {undefined === loop ? (\n              index < 14 ? (\n                index + 1\n              ) : (\n                ''\n              )\n            ) : (\n              <Player gif={loop.gif} width={300} configuration={loop.configuration} />\n            )}\n            {index < 14 && (\n              <Actions>\n                {undefined === loop ? (\n                  <>\n                    <Action onClick={() => onOpenAddLoop(index)}>Add</Action>\n                  </>\n                ) : (\n                  <>\n                    <Action onClick={() => onRemoveLoop(index)}>Delete</Action>\n                  </>\n                )}\n              </Actions>\n            )}\n          </Item>\n        ))}\n        <Wtf onClick={() => onOpenInfoLoop()}>Wtf?</Wtf>\n        <Like onClick={() => onOpenLikeLoop()}>Like?</Like>\n      </Grid>\n    </Container>\n  );\n};\n\nexport {Loops};\n","import {useEffect, useCallback} from 'react';\n\nconst beforeUnloadMessage = 'By leaving the app you will loose your changes. Are you sure you want to leave?';\nconst useBeforeLeave = (canLeave: () => boolean) => {\n  const handleUnload = useCallback(\n    (event: BeforeUnloadEvent) => {\n      if (canLeave()) {\n        return;\n      }\n\n      event.preventDefault();\n      event.returnValue = beforeUnloadMessage;\n\n      return beforeUnloadMessage;\n    },\n    [canLeave]\n  );\n  useEffect(() => {\n    window.addEventListener('beforeunload', handleUnload);\n\n    return () => window.removeEventListener('beforeunload', handleUnload);\n  }, [handleUnload]);\n};\n\nexport {useBeforeLeave};\n","import React, {useState, useCallback} from 'react';\nimport styled from 'styled-components';\nimport {useBooleanState} from './hooks/boolean';\nimport {Adder} from './Component/Adder/Adder';\nimport {Loop} from './model/loop';\nimport {saveAs} from 'file-saver';\nimport {generateZip} from './tools/zip';\nimport {Loops} from './Component/Loops';\nimport {sendEvent, UserEvent, sendError} from './tools/analytics';\nimport {Wtf} from './Component/Wtf';\nimport {Like} from './Component/Like';\nimport {useBeforeLeave} from './hooks/leave';\nimport {LoadingContext} from './context/loading';\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n  font-family: 'Muli', sans-serif;\n  box-sizing: border-box;\n`;\n\nconst Header = styled.div`\n  height: 60px;\n  display: flex;\n  color: white;\n  background: rgb(19, 19, 19);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 30px;\n  font-weight: 100;\n  width: 100%;\n`;\nconst Footer = styled.div`\n  height: 60px;\n  display: flex;\n  color: white;\n  background: rgb(19, 19, 19);\n`;\n\nconst AddButton = styled.div`\n  padding: 0 30px;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  box-sizing: border-box;\n  background-color: ${(props) => props.theme.color.yellow};\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst Spacer = styled.div`\n  flex: 1;\n`;\n\nconst DownloadButton = styled.div`\n  padding: 0 30px;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  box-sizing: border-box;\n  background-color: ${(props) => props.theme.color.blue};\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst useLoopState = (): [Loop[], (loop: Loop) => void, (loopToRemove: number) => void] => {\n  const [loops, setLoops] = useState<Loop[]>([]);\n\n  const setLoop = useCallback(\n    (newLoop: Loop) => {\n      const updatedLoops = [...loops].filter((loop) => loop.sprite !== newLoop.sprite);\n\n      setLoops([...updatedLoops, newLoop]);\n    },\n    [loops, setLoops]\n  );\n  const removeLoop = useCallback(\n    (loopToRemove: number) => {\n      const updatedLoops = [...loops].filter((loop) => loop.sprite !== loopToRemove);\n\n      setLoops(updatedLoops);\n    },\n    [loops, setLoops]\n  );\n\n  return [loops, setLoop, removeLoop];\n};\n\nconst App = () => {\n  const [isAddModalOpen, openAddModal, closeAddModal] = useBooleanState(false);\n  const [isInfoModalOpen, openInfoModal, closeInfoModal] = useBooleanState(false);\n  const [isLikeModalOpen, openLikeModal, closeLikeModal] = useBooleanState(false);\n  const [loops, setLoop, removeLoop] = useLoopState();\n  const [currentSprite, setSprite] = useState<number | null>(null);\n  useBeforeLeave(useCallback(() => loops.length === 0 || isLikeModalOpen, [loops, isLikeModalOpen]));\n\n  return (\n    <LoadingContext.Provider value={useState<boolean>(false)}>\n      <Container>\n        <Header>\n          <span>Gif looper generator</span>\n        </Header>\n        <Loops\n          loops={loops}\n          onOpenInfoLoop={() => {\n            sendEvent(UserEvent.OpenWtf);\n            openInfoModal();\n          }}\n          onRemoveLoop={(sprite: number) => {\n            sendEvent(UserEvent.LoopRemoved);\n            removeLoop(sprite);\n          }}\n          onOpenLikeLoop={() => {\n            sendEvent(UserEvent.OpenLike);\n            openLikeModal();\n          }}\n          onOpenAddLoop={(sprite: number) => {\n            sendEvent(UserEvent.StartAdding, {loop_number: sprite, from: 'loop'});\n            setSprite(sprite);\n            openAddModal();\n          }}\n        />\n        <Footer>\n          <AddButton\n            onClick={() => {\n              sendEvent(UserEvent.StartAdding, {from: 'button'});\n              openAddModal();\n            }}\n          >\n            <span>Add</span>\n          </AddButton>\n          <Spacer />\n          {0 !== loops.length && (\n            <DownloadButton\n              onClick={async () => {\n                sendEvent(UserEvent.Download, {loop_count: loops.length});\n                try {\n                  const zip = await generateZip(loops);\n                  saveAs(zip, 'GIFs.zip');\n                } catch (error) {\n                  sendError('cannot_generate_zip', error);\n                }\n              }}\n            >\n              <span>Download</span>\n            </DownloadButton>\n          )}\n        </Footer>\n        {isAddModalOpen && (\n          <Adder\n            dismissModal={() => closeAddModal()}\n            onLoopAdd={(loop: Loop) => {\n              if (currentSprite === null) {\n                sendEvent(UserEvent.LoopAdded, {\n                  loop_count: loops.length,\n                  from: 'button',\n                });\n              } else {\n                sendEvent(UserEvent.LoopAdded, {\n                  loop_count: loops.length,\n                  from: 'sprite',\n                  loop: currentSprite,\n                });\n              }\n              closeAddModal();\n              setLoop(loop);\n              setSprite(null);\n            }}\n            initialSprite={currentSprite}\n          />\n        )}\n        {isInfoModalOpen && (\n          <Wtf\n            dismissModal={() => {\n              sendEvent(UserEvent.CloseWtf);\n              closeInfoModal();\n            }}\n          />\n        )}\n        {isLikeModalOpen && (\n          <Like\n            dismissModal={() => {\n              sendEvent(UserEvent.CloseLike);\n              closeLikeModal();\n            }}\n          />\n        )}\n      </Container>\n    </LoadingContext.Provider>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport {sendError} from '../tools/analytics';\n\nclass ErrorBoundary extends React.Component<{}, {hasError: boolean; error: null | Error}> {\n  constructor(props: {}) {\n    super(props);\n    this.state = {hasError: false, error: null};\n  }\n\n  static getDerivedStateFromError(error: Error) {\n    return {hasError: true, error};\n  }\n\n  componentDidCatch(error: Error, errorInfo: any) {\n    console.error(error);\n    sendError('fatal_error', error);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <React.Fragment>\n          <h1>Something went wrong: {null !== this.state.error ? this.state.error.message : ''}</h1>\n          <span\n            onClick={() => {\n              this.setState({hasError: false, error: null});\n            }}\n          >\n            Click here to dismiss this error\n          </span>\n        </React.Fragment>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\nexport {ErrorBoundary};\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport {ThemeProvider} from 'styled-components';\nimport {sendEvent, UserEvent} from './tools/analytics';\nimport {ErrorBoundary} from './Component/Error';\n\nconst theme = {\n  addModal: {\n    windowSize: 600,\n    sourceCount: 2,\n    spacing: 60,\n  },\n  color: {\n    yellow: 'rgb(233, 177, 61)',\n    red: 'rgb(193, 51, 56)',\n    blue: 'rgb(39, 94, 132)',\n    white: 'rgb(208, 208, 208)',\n    grey: 'rgb(128, 128, 128)',\n    lightGrey: 'rgb(179, 179, 179)',\n    black: 'rgb(18, 18, 18)',\n  },\n};\n\nsendEvent(UserEvent.AppLaunch);\n\nReactDOM.render(\n  <React.StrictMode>\n    <ErrorBoundary>\n      <ThemeProvider theme={theme}>\n        <App />\n      </ThemeProvider>\n    </ErrorBoundary>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n"],"sourceRoot":""}