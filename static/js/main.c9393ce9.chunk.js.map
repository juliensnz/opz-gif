{"version":3,"sources":["tools/canvas.ts","Component/Style/Back.tsx","tools/zip.ts","Component/Loops.tsx","hooks/leave.ts","App.tsx","hooks/loop.ts","serviceWorker.ts","Component/Error.tsx","index.tsx","context/loading.ts","hooks/boolean.ts","model/loop.ts","hooks/shortcut.ts","tools/key.ts","Component/Loading.tsx","tools/analytics.ts","Component/Player.tsx","tools/gif.ts","Component/Adder/Adder.tsx","Component/Adder/Adder/SpriteSelector.tsx","Component/Wtf.tsx","Component/Like.tsx","hooks/focus.ts","hooks/mounted.ts","Component/Adder/Adder/SourceSelector/UrlSource.tsx","Component/Adder/Adder/SourceSelector/FileSource.tsx","Component/Adder/Adder/SourceSelector/GiphySource.tsx","Component/Adder/Adder/SourceSelector.tsx","Component/Adder/Adder/LoopConfigurator/Handle.tsx","Component/Adder/Adder/LoopConfigurator/Cutter.tsx","Component/Adder/Adder/LoopConfigurator/SampleModeSelector.tsx","Component/Adder/Adder/LoopConfigurator.tsx","Component/Modal.tsx","../node_modules/@giphy/js-brand/dist sync"],"names":["FRAME_WIDTH","FRAME_HEIGHT","FRAME_RATIO","isTooWide","imageData","width","height","addImageToCanvas","context","croppedWidth","croppedHeight","left","putImageData","top","getTrimedFrames","gif","frameCount","Math","floor","getFrameLength","Array","map","_value","index","getFrame","length","getSampledFrames","animate","canvas","frames","cpt","setInterval","getContext","drawImage","totalFrames","frameNumber","frameStep","getImages","configuration","trimedGif","start","end","previousPosition","filter","frame","position","delay","filterGif","mode","Sample","Trim","getAnimate","key","scaledCanvas","document","createElement","scaledContext","Error","scale","getImageData","getCroppedImageData","data","getOffsetY","generateSprite","images","a","toDataURL","Back","styled","div","leading","css","props","vertical","theme","addModal","spacing","windowSize","generateZip","loops","Promise","resolve","zip","JSZip","folder","loop","sprite","file","replace","base64","generateAsync","type","then","content","Container","Grid","Item","color","lightGrey","white","Wtf","Like","Actions","red","black","DeleteAction","EditAction","blue","AddAction","green","Loops","onOpenAddLoop","onRemoveLoop","onEditLoop","onOpenInfoLoop","onOpenLikeLoop","nonEmptyLoops","_content","find","data-testid","undefined","Player","preview","onClick","beforeUnloadMessage","Header","Footer","AddButton","yellow","Spacer","DownloadButton","App","useBooleanState","isAddModalOpen","openAddModal","closeAddModal","isInfoModalOpen","openInfoModal","closeInfoModal","isLikeModalOpen","openLikeModal","closeLikeModal","useState","setLoops","setLoop","useCallback","newLoop","updatedLoops","removeLoop","loopToRemove","useLoopState","createEmptyLoop","currentLoop","setCurrentLoop","canLeave","handleUnload","event","preventDefault","returnValue","useEffect","window","addEventListener","removeEventListener","useBeforeLeave","Provider","value","sendEvent","UserEvent","OpenWtf","LoopRemoved","getLoop","sendError","StartEditing","gifLength","getGifLength","OpenLike","StartAdding","loop_number","from","createLoopFromSprite","Download","loop_count","saveAs","Adder","dismissModal","onLoopAdd","LoopAdded","isLoop","LoopEdited","initialLoop","CloseWtf","CloseLike","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","onUpdate","onSuccess","catch","error","ErrorBoundary","hasError","errorInfo","this","Fragment","message","setState","children","React","Component","AppLaunch","ReactDOM","render","StrictMode","sourceCount","grey","getElementById","URL","process","href","origin","fetch","headers","response","contentType","get","status","indexOf","ready","unregister","reload","checkValidServiceWorker","LoadingContext","createContext","defaultValue","setValue","updatePreview","useShortcut","callback","memoizedCallback","code","Key","Bar","Progress","Loading","isLoading","sessionId","Date","now","userId","getUserId","localStorage","getItem","c","r","random","toString","setItem","ErrorOccured","method","cache","body","JSON","stringify","api_key","events","user_id","session_id","device_id","event_type","time","event_properties","app_version","Canvas","cssWidth","canvasRef","useRef","current","timer","clearInterval","ref","blockedProviders","getBase64","reader","FileReader","onload","target","result","readAsDataURL","getImage","url","image","Image","src","reduce","getDataUrl","reject","xhr","XMLHttpRequest","onloadend","onerror","some","provider","open","responseType","send","getSuperGif","superGif","SuperGif","auto_play","load","getGif","urlData","appendChild","get_frames","Scroller","level","getLevel","isEdit","isConfirmed","setComfirmed","isVisible","show","useContext","loading","setLoading","setImmediate","dismiss","CancelAdd","Escape","previous","onGifSelected","initialConfiguration","onLoopConfirmation","onSpriteConfirmation","Sprite","SpriteSelector","Content","Version","Donate","input","Form","form","action","name","title","alt","useAutoFocus","focus","useMounted","beforeUnmount","isMountedRef","selected","Button","visible","Input","Submit","span","ErrorDisplay","UrlSource","onSelected","setUrl","isMounted","setError","urlRef","setFocus","Source","Url","setTimeout","submit","gifData","newGif","GifSelected","placeholder","onChange","currentTarget","onKeyPress","DropZone","Explanation","FileSource","files","File","gf","GiphyFetch","SelectionZone","PoweredContainer","PoweredLogo","img","GiphySource","search","setSearch","currentSearch","setCurrentSearch","searchRef","Giphy","fetchGifs","offset","sort","lang","limit","doSearch","columns","hideAttribution","onGifClick","original","source","getTranslation","SourceSelector","setSource","HandlePosition","Grabber","HandleGrabber","Pin","StartHandle","EndHandle","HandleTime","Handle","handlePosition","min","max","onEnd","Element","Start","parentWidth","setParentWidth","currentPosition","setCurrentPosition","grabberStartX","setGrabberStartX","startingPosition","setStartingPosition","isDragged","setIsDragged","containerRef","parentNode","getBoundingClientRect","mouseUp","mouseDown","clientX","round","mouseMove","newPosition","newValue","style","onMouseDown","onMouseMove","getTimeLabel","Timeline","Timing","CutBoard","End","TrimStart","TrimEnd","TrimCenter","label","includes","Cutter","onStartChange","newStart","onEndChange","newEnd","Mode","SampleModeSelector","Size","fullSize","LoadingContainer","Configurator","LoopConfigurator","ThemeContext","setConfiguration","isDefaultSample","isDefaultTrim","isEmptyConfiguration","ConfigurationChange","useConfiguration","setPreview","useGeneratePreview","size","Long","setSize","Short","Medium","useSize","onModeChange","newMode","newStartEnd","onCutChange","Mask","Modal","Dismiss","Title","webpackEmptyContext","req","e","keys","module","exports","id"],"mappings":"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","file":"static/js/main.c9393ce9.chunk.js","sourcesContent":["import {GIF, Sample, Configuration, Frame, getFrameLength} from './gif';\n\nconst FRAME_WIDTH = 1014;\nconst FRAME_HEIGHT = 468;\nconst ANIMATION_LENGTH = 2000;\nconst FRAME_RATIO = FRAME_WIDTH / FRAME_HEIGHT;\n\nconst isTooWide = (imageData: ImageData) => imageData.width / imageData.height > FRAME_RATIO;\n\nconst addImageToCanvas = (context: CanvasRenderingContext2D, imageData: ImageData) => {\n  if (!isTooWide(imageData)) {\n    const croppedWidth = imageData.width;\n    const croppedHeight = (imageData.width / FRAME_WIDTH) * FRAME_HEIGHT;\n    const left = 0;\n    const top = (imageData.height - croppedHeight) / 2;\n\n    context.putImageData(imageData, 0, -top, left, top, croppedWidth, croppedHeight);\n  } else {\n    const croppedWidth = (imageData.height / FRAME_HEIGHT) * FRAME_WIDTH;\n    const croppedHeight = imageData.height;\n    const left = (imageData.width - croppedWidth) / 2;\n    const top = 0;\n    context.putImageData(imageData, -left, 0, left, top, croppedWidth, croppedHeight);\n  }\n};\n\nconst drawImage = (canvas: HTMLCanvasElement, imageData: ImageData) => {\n  const context = canvas.getContext('2d');\n  if (null === context) return;\n\n  addImageToCanvas(context, imageData);\n};\n\nconst getAnimate = (configuration: Configuration) =>\n  configuration.mode === Sample.Trim ? getTrimedFrames : getSampledFrames;\n\nconst getTrimedFrames = (gif: GIF) => {\n  const frameCount = Math.floor(ANIMATION_LENGTH / getFrameLength(gif));\n\n  return [...new Array(30)].map((_value: any, index: number) =>\n    getFrame(frameCount >= gif.length ? gif.length : frameCount, index)\n  );\n};\nconst getSampledFrames = (gif: GIF) => {\n  return [...new Array(30)].map((_value: any, index: number) => getFrame(gif.length, index));\n};\n\nconst filterGif = (gif: GIF, start: number, end: number): GIF => {\n  let previousPosition = 0;\n  return gif.filter((frame: Frame) => {\n    const position = previousPosition + frame.delay * 10;\n\n    previousPosition = position;\n    return position >= start && position <= end;\n  });\n};\n\nconst animate = (canvas: HTMLCanvasElement, frames: ImageData[]): number => {\n  let cpt = 0;\n\n  return setInterval(() => {\n    drawImage(canvas, frames[cpt % 30]);\n    cpt++;\n  }, ANIMATION_LENGTH / 30);\n};\n\nconst scaleImage = (canvas: HTMLCanvasElement, gif: GIF) => {\n  const firstFrame = gif[0].data;\n  const scale = !isTooWide(firstFrame) ? FRAME_WIDTH / firstFrame.width : FRAME_HEIGHT / firstFrame.height;\n\n  (canvas.getContext('2d') as any).scale(scale, scale);\n};\n\nconst clearCanvas = (canvas: HTMLCanvasElement) => {\n  (canvas.getContext('2d') as any).clearRect(0, 0, FRAME_WIDTH, FRAME_HEIGHT);\n};\n\nconst getFrame = (totalFrames: number, frameNumber: number) => {\n  const frameStep = totalFrames / 30;\n\n  return Math.floor(frameNumber * frameStep);\n};\n\nconst getCroppedImageData = (imageData: ImageData) => {\n  const scaledCanvas = document.createElement('canvas');\n  scaledCanvas.width = FRAME_WIDTH;\n  scaledCanvas.height = FRAME_HEIGHT;\n  const scaledContext = scaledCanvas.getContext('2d');\n  if (null === scaledContext) throw Error('Cannot get scaled context');\n\n  const canvas = document.createElement('canvas');\n  canvas.width = imageData.width;\n  canvas.height = imageData.width;\n  const scale = FRAME_WIDTH / imageData.width;\n  const context = canvas.getContext('2d');\n  if (null === context) throw Error('Cannot get context');\n  addImageToCanvas(context, imageData);\n\n  scaledContext.scale(scale, scale);\n  scaledContext.drawImage(canvas, 0, 0);\n\n  return scaledContext.getImageData(0, 0, FRAME_WIDTH, FRAME_HEIGHT);\n};\n\nconst getImages = (gif: GIF, configuration: Configuration): ImageData[] => {\n  const trimedGif = filterGif(gif, configuration.start, configuration.end);\n  const frames = getAnimate(configuration)(trimedGif);\n\n  return frames.map((key: number) => getCroppedImageData(trimedGif[key].data));\n};\n\nconst getOffsetX = (index: number): number => 5 + (FRAME_WIDTH + 10) * (index % 4);\nconst getOffsetY = (index: number): number => 22 + (FRAME_HEIGHT + 44) * Math.floor(index / 4);\n\nconst generateSprite = async (images: ImageData[]): Promise<string> => {\n  const canvas = document.createElement('canvas');\n  canvas.width = 4096;\n  canvas.height = 4096;\n  const context = canvas.getContext('2d');\n  if (null === context) throw Error('Cannot create canvas');\n\n  for (let key in images) {\n    context.putImageData(images[key], getOffsetX(key as any), getOffsetY(key as any));\n  }\n\n  context.drawImage(canvas, 0, 0);\n\n  return canvas.toDataURL('image/png');\n};\n\nexport {\n  addImageToCanvas,\n  scaleImage,\n  animate,\n  getAnimate,\n  generateSprite,\n  getImages,\n  clearCanvas,\n  isTooWide,\n  FRAME_WIDTH,\n  FRAME_HEIGHT,\n};\n","import styled, {css} from 'styled-components';\n\nconst Back = styled.div<{vertical: boolean; leading?: boolean}>`\n  position: absolute;\n  ${({leading = true}) =>\n    leading\n      ? css`\n          top: 0;\n        `\n      : css`\n          bottom: 0;\n        `}\n\n  ${(props) =>\n    props.vertical\n      ? css`\n          right: ${(props) => props.theme.addModal.spacing}px;\n          transform: rotate(-90deg);\n          transform-origin: ${(props) => props.theme.addModal.windowSize}px 0;\n        `\n      : css`\n          left: 0;\n        `}\n\n  height: ${(props) => props.theme.addModal.spacing}px;\n  width: ${(props) => props.theme.addModal.windowSize}px;\n  text-align: center;\n  line-height: ${(props) => props.theme.addModal.spacing}px;\n  font-size: 20px;\n  color: white;\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nexport {Back};\n","import JSZip from 'jszip';\nimport {generateSprite, getImages} from './canvas';\nimport {Loop} from '../model/loop';\n\nconst generateZip = (loops: Loop[]): Promise<Blob> => {\n  return new Promise(async (resolve) => {\n    const zip = new JSZip();\n    const folder = zip.folder('GIFs');\n    for (const loop of loops) {\n      const sprite = await generateSprite(getImages(loop.gif, loop.configuration));\n      if ('' === sprite) return;\n\n      folder.file(\n        `GIF-Looper-Template-Spritesheet${loop.sprite + 1 < 10 ? '0' : ''}${loop.sprite + 1}.png`,\n        sprite.replace('data:image/png;base64,', ''),\n        {\n          base64: true,\n        }\n      );\n    }\n\n    zip.generateAsync({type: 'blob'}).then(function (content) {\n      resolve(content);\n    });\n  });\n};\n\nexport {generateZip};\n","import React from 'react';\nimport {Loop} from '../model/loop';\nimport styled from 'styled-components';\nimport {Player} from './Player';\nimport {GIF} from '../tools/gif';\n\nconst Container = styled.div`\n  flex: 1;\n  display: flex;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 10px 0;\n`;\nconst Grid = styled.div`\n  display: grid;\n  grid-gap: 10px;\n  grid-template-columns: repeat(4, 300px);\n`;\n\nconst Item = styled.div`\n  position: relative;\n  display: flex;\n  justify-content: center;\n  height: 138px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border: 1px solid ${(props) => props.theme.color.lightGrey};\n  border-radius: 3px;\n  font-size: 40px;\n  color: ${(props) => props.theme.color.lightGrey};\n  background: repeating-linear-gradient(\n    120deg,\n    ${(props) => props.theme.color.white},\n    ${(props) => props.theme.color.white} 5px,\n    ${(props) => props.theme.color.lightGrey} 5px,\n    ${(props) => props.theme.color.lightGrey} 6px\n  );\n`;\n\nconst Wtf = styled(Item)`\n  &:hover {\n    cursor: pointer;\n  }\n`;\nconst Like = styled(Item)`\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst Actions = styled.div`\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  background: ${(props) => props.theme.color.red};\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-weight: 100;\n  font-size: 25px;\n  color: ${(props) => props.theme.color.black};\n  opacity: 0;\n  transition: opacity 0.2s ease-in-out;\n  display: flex;\n  color: white;\n\n  &:hover {\n    cursor: pointer;\n    opacity: 1;\n  }\n`;\n\nconst DeleteAction = styled.div`\n  flex: 1;\n  justify-content: center;\n  align-items: center;\n  display: flex;\n  height: 100%;\n  background: ${(props) => props.theme.color.red};\n`;\n\nconst EditAction = styled.div`\n  flex: 1;\n  justify-content: center;\n  align-items: center;\n  display: flex;\n  height: 100%;\n  background: ${(props) => props.theme.color.blue};\n`;\n\nconst AddAction = styled.div`\n  flex: 1;\n  justify-content: center;\n  align-items: center;\n  display: flex;\n  height: 100%;\n  background: ${(props) => props.theme.color.green};\n`;\n\nconst Loops = ({\n  loops,\n  onOpenAddLoop,\n  onRemoveLoop,\n  onEditLoop,\n  onOpenInfoLoop,\n  onOpenLikeLoop,\n}: {\n  loops: Loop[];\n  onOpenAddLoop: (sprite: number) => void;\n  onEditLoop: (sprite: number, gif: GIF) => void;\n  onRemoveLoop: (sprite: number) => void;\n  onOpenInfoLoop: () => void;\n  onOpenLikeLoop: () => void;\n}) => {\n  const nonEmptyLoops = [...new Array(14)].map((_content, index: number) => {\n    return loops.find((loop) => loop.sprite === index);\n  });\n\n  return (\n    <Container>\n      <Grid>\n        {nonEmptyLoops.map((loop: Loop | undefined, index: number) => (\n          <Item key={index} data-testid={`loop_container_${index}`}>\n            {undefined === loop ? index < 14 ? index + 1 : '' : <Player preview={loop.preview} width={300} />}\n            {index < 14 && (\n              <Actions>\n                {undefined === loop ? (\n                  <>\n                    <AddAction onClick={() => onOpenAddLoop(index)}>Add</AddAction>\n                  </>\n                ) : (\n                  <>\n                    <EditAction onClick={() => onEditLoop(index, loop.gif)}>Edit</EditAction>\n                    <DeleteAction onClick={() => onRemoveLoop(index)}>Delete</DeleteAction>\n                  </>\n                )}\n              </Actions>\n            )}\n          </Item>\n        ))}\n        <Wtf onClick={() => onOpenInfoLoop()}>Wtf?</Wtf>\n        <Like onClick={() => onOpenLikeLoop()}>Like?</Like>\n      </Grid>\n    </Container>\n  );\n};\n\nexport {Loops};\n","import {useEffect, useCallback} from 'react';\n\nconst beforeUnloadMessage = 'By leaving the app you will loose your changes. Are you sure you want to leave?';\nconst useBeforeLeave = (canLeave: () => boolean) => {\n  const handleUnload = useCallback(\n    (event: BeforeUnloadEvent) => {\n      if (canLeave()) {\n        return;\n      }\n\n      event.preventDefault();\n      event.returnValue = beforeUnloadMessage;\n\n      return beforeUnloadMessage;\n    },\n    [canLeave]\n  );\n  useEffect(() => {\n    window.addEventListener('beforeunload', handleUnload);\n\n    return () => window.removeEventListener('beforeunload', handleUnload);\n  }, [handleUnload]);\n};\n\nexport {useBeforeLeave};\n","import React, {useState, useCallback} from 'react';\nimport styled from 'styled-components';\nimport {useBooleanState} from './hooks/boolean';\nimport {Adder} from './Component/Adder/Adder';\nimport {Loop, getLoop, EmptyLoop, createEmptyLoop, createLoopFromSprite, isLoop} from './model/loop';\nimport {saveAs} from 'file-saver';\nimport {generateZip} from './tools/zip';\nimport {Loops} from './Component/Loops';\nimport {sendEvent, UserEvent, sendError} from './tools/analytics';\nimport {Wtf} from './Component/Wtf';\nimport {Like} from './Component/Like';\nimport {useBeforeLeave} from './hooks/leave';\nimport {LoadingContext} from './context/loading';\nimport {getGifLength} from './tools/gif';\nimport {useLoopState} from './hooks/loop';\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n  font-family: 'Muli', sans-serif;\n  box-sizing: border-box;\n`;\n\nconst Header = styled.div`\n  height: 60px;\n  display: flex;\n  color: white;\n  background: rgb(19, 19, 19);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 30px;\n  font-weight: 100;\n  width: 100%;\n  flex-shrink: 0;\n  position: sticky;\n  top: 0;\n  z-index: 1;\n`;\nconst Footer = styled.div`\n  height: 60px;\n  display: flex;\n  color: white;\n  background: rgb(19, 19, 19);\n  flex-shrink: 0;\n  position: sticky;\n  bottom: 0;\n`;\n\nconst AddButton = styled.div`\n  padding: 0 30px;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  box-sizing: border-box;\n  background-color: ${(props) => props.theme.color.yellow};\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst Spacer = styled.div`\n  flex: 1;\n`;\n\nconst DownloadButton = styled.div`\n  padding: 0 30px;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  box-sizing: border-box;\n  background-color: ${(props) => props.theme.color.blue};\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst App = () => {\n  const [isAddModalOpen, openAddModal, closeAddModal] = useBooleanState(false);\n  const [isInfoModalOpen, openInfoModal, closeInfoModal] = useBooleanState(false);\n  const [isLikeModalOpen, openLikeModal, closeLikeModal] = useBooleanState(false);\n  const [loops, setLoop, removeLoop] = useLoopState();\n  const [currentLoop, setCurrentLoop] = useState<Loop | EmptyLoop>(createEmptyLoop());\n  useBeforeLeave(useCallback(() => loops.length === 0 || isLikeModalOpen, [loops, isLikeModalOpen]));\n\n  return (\n    <LoadingContext.Provider value={useState<boolean>(false)}>\n      <Container>\n        <Header>\n          <span>Gif looper generator</span>\n        </Header>\n        <Loops\n          loops={loops}\n          onOpenInfoLoop={() => {\n            sendEvent(UserEvent.OpenWtf);\n            openInfoModal();\n          }}\n          onRemoveLoop={(sprite: number) => {\n            sendEvent(UserEvent.LoopRemoved);\n            removeLoop(sprite);\n          }}\n          onEditLoop={(sprite: number) => {\n            const loop = getLoop(loops, sprite) as Loop;\n            if (undefined === loop) {\n              sendError('cannot_find_loop', new Error(`Loop ${sprite} not found`));\n            }\n\n            sendEvent(UserEvent.StartEditing, {\n              sprite,\n              frameCount: loop.gif.length,\n              gifLength: getGifLength(loop.gif),\n              configuration: loop.configuration,\n            });\n            setCurrentLoop(loop);\n            openAddModal();\n          }}\n          onOpenLikeLoop={() => {\n            sendEvent(UserEvent.OpenLike);\n            openLikeModal();\n          }}\n          onOpenAddLoop={(sprite: number) => {\n            sendEvent(UserEvent.StartAdding, {loop_number: sprite, from: 'loop'});\n            setCurrentLoop(createLoopFromSprite(sprite));\n            openAddModal();\n          }}\n        />\n        <Footer>\n          <AddButton\n            data-testid=\"main_add_button\"\n            onClick={() => {\n              sendEvent(UserEvent.StartAdding, {from: 'button'});\n              openAddModal();\n            }}\n          >\n            <span>Add</span>\n          </AddButton>\n          <Spacer />\n          {0 !== loops.length && (\n            <DownloadButton\n              data-testid=\"main_download_button\"\n              onClick={async () => {\n                sendEvent(UserEvent.Download, {loop_count: loops.length});\n                try {\n                  const zip = await generateZip(loops);\n                  saveAs(zip, 'GIFs.zip');\n                } catch (error) {\n                  sendError('cannot_generate_zip', error);\n                }\n              }}\n            >\n              <span>Download</span>\n            </DownloadButton>\n          )}\n        </Footer>\n        {isAddModalOpen && (\n          <Adder\n            dismissModal={() => closeAddModal()}\n            onLoopAdd={(loop: Loop) => {\n              if (currentLoop.sprite === null) {\n                sendEvent(UserEvent.LoopAdded, {\n                  loop_count: loops.length,\n                  from: 'button',\n                  configuration: loop.configuration,\n                });\n              } else if (isLoop(currentLoop)) {\n                sendEvent(UserEvent.LoopEdited, {\n                  loop_count: loops.length,\n                  from: 'sprite',\n                  loop: currentLoop.sprite,\n                  configuration: loop.configuration,\n                });\n              } else {\n                sendEvent(UserEvent.LoopAdded, {\n                  loop_count: loops.length,\n                  from: 'sprite',\n                  loop: currentLoop.sprite,\n                  configuration: loop.configuration,\n                });\n              }\n              closeAddModal();\n              setLoop(loop);\n              setCurrentLoop(createEmptyLoop());\n            }}\n            initialLoop={currentLoop}\n          />\n        )}\n        {isInfoModalOpen && (\n          <Wtf\n            dismissModal={() => {\n              sendEvent(UserEvent.CloseWtf);\n              closeInfoModal();\n            }}\n          />\n        )}\n        {isLikeModalOpen && (\n          <Like\n            dismissModal={() => {\n              sendEvent(UserEvent.CloseLike);\n              closeLikeModal();\n            }}\n          />\n        )}\n      </Container>\n    </LoadingContext.Provider>\n  );\n};\n\nexport default App;\n","import {useState, useCallback} from 'react';\nimport {Loop} from '../model/loop';\n\nconst useLoopState = (): [Loop[], (loop: Loop) => void, (loopToRemove: number) => void] => {\n  const [loops, setLoops] = useState<Loop[]>([]);\n\n  const setLoop = useCallback(\n    (newLoop: Loop) => {\n      const updatedLoops = [...loops].filter((loop) => loop.sprite !== newLoop.sprite);\n\n      setLoops([...updatedLoops, newLoop]);\n    },\n    [loops, setLoops]\n  );\n  const removeLoop = useCallback(\n    (loopToRemove: number) => {\n      const updatedLoops = [...loops].filter((loop) => loop.sprite !== loopToRemove);\n\n      setLoops(updatedLoops);\n    },\n    [loops, setLoops]\n  );\n\n  return [loops, setLoop, removeLoop];\n};\n\nexport {useLoopState};\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport {sendError} from '../tools/analytics';\n\nclass ErrorBoundary extends React.Component<{}, {hasError: boolean; error: null | Error}> {\n  constructor(props: {}) {\n    super(props);\n    this.state = {hasError: false, error: null};\n  }\n\n  static getDerivedStateFromError(error: Error) {\n    return {hasError: true, error};\n  }\n\n  componentDidCatch(error: Error, errorInfo: any) {\n    console.error(error);\n    sendError('fatal_error', error);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <React.Fragment>\n          <h1>Something went wrong: {null !== this.state.error ? this.state.error.message : ''}</h1>\n          <span\n            onClick={() => {\n              this.setState({hasError: false, error: null});\n            }}\n          >\n            Click here to dismiss this error\n          </span>\n        </React.Fragment>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\nexport {ErrorBoundary};\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport {ThemeProvider} from 'styled-components';\nimport {sendEvent, UserEvent} from './tools/analytics';\nimport {ErrorBoundary} from './Component/Error';\n\nconst theme = {\n  addModal: {\n    windowSize: 600,\n    sourceCount: 3,\n    spacing: 60,\n  },\n  color: {\n    yellow: 'rgb(233, 177, 61)',\n    red: 'rgb(193, 51, 56)',\n    blue: 'rgb(39, 94, 132)',\n    green: 'rgb(43, 102, 60)',\n    white: 'rgb(208, 208, 208)',\n    grey: 'rgb(128, 128, 128)',\n    lightGrey: 'rgb(179, 179, 179)',\n    black: 'rgb(18, 18, 18)',\n  },\n};\n\nsendEvent(UserEvent.AppLaunch);\n\nReactDOM.render(\n  <React.StrictMode>\n    <ErrorBoundary>\n      <ThemeProvider theme={theme}>\n        <App />\n      </ThemeProvider>\n    </ErrorBoundary>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n","import {createContext} from 'react';\n\nconst LoadingContext = createContext<[boolean, (newValue: boolean) => void]>([false, () => {}]);\n\nexport {LoadingContext};\n","import {useState} from 'react';\n\nconst useBooleanState = (defaultValue: boolean): [boolean, () => void, () => void] => {\n  const [value, setValue] = useState(defaultValue);\n\n  return [value, () => setValue(true), () => setValue(false)];\n};\n\nexport {useBooleanState};\n","import {GIF, Configuration} from '../tools/gif';\nimport {getImages} from '../tools/canvas';\n\nexport type Loop = {\n  gif: GIF;\n  configuration: Configuration;\n  sprite: number;\n  preview: Preview;\n};\nexport type EmptyLoop = {\n  gif: GIF;\n  configuration: Configuration | null;\n  sprite: number | null;\n  preview: Preview;\n};\n\nexport type Preview = ImageData[];\n\nexport const createEmptyLoop = (): EmptyLoop => ({\n  gif: [],\n  configuration: null,\n  sprite: null,\n  preview: [],\n});\nexport const createLoopFromSprite = (sprite: number): EmptyLoop => ({\n  gif: [],\n  configuration: null,\n  sprite: sprite,\n  preview: [],\n});\nexport const updatePreview = (loop: Loop): Loop => {\n  return {...loop, preview: getImages(loop.gif, loop.configuration)};\n};\n\nexport const isLoop = (loop: Loop | EmptyLoop): loop is Loop =>\n  0 !== loop.gif.length && null !== loop.configuration && null !== loop.sprite;\n\nexport const getLoop = (loops: Loop[], index: number) => loops.find((loop) => loop.sprite === index);\n","import {useCallback, useEffect} from 'react';\nimport {Key} from '../tools/key';\n\nconst useShortcut = (key: Key, callback: () => void) => {\n  const memoizedCallback = useCallback((event: KeyboardEvent) => (key === event.code ? callback() : null), [\n    key,\n    callback,\n  ]);\n\n  useEffect(() => {\n    document.addEventListener('keydown', memoizedCallback);\n    return () => document.removeEventListener('keydown', memoizedCallback);\n  }, [memoizedCallback]);\n};\n\nexport {useShortcut};\n","enum Key {\n  Space = ' ',\n  Enter = 'Enter',\n  NumpadEnter = 'NumpadEnter',\n  Backspace = 'Backspace',\n  Escape = 'Escape',\n  ArrowLeft = 'ArrowLeft',\n  ArrowRight = 'ArrowRight',\n}\n\nexport {Key};\n","import React from 'react';\nimport styled from 'styled-components';\n\nconst Container = styled.div`\n  position: absolute;\n  height: 100%;\n  right: 0;\n  top: 0;\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n`;\n\nconst Bar = styled.div`\n  width: 50px;\n  height: 20px;\n  border-radius: 10px;\n  margin-right: 20px;\n  overflow: hidden;\n  border: 1px solid ${(props) => props.theme.color.white};\n`;\n\nconst Progress = styled.div`\n  @keyframes moveIt {\n    from {\n      background-position: bottom left;\n    }\n    to {\n      background-position: top right;\n    }\n  }\n\n  height: 100%;\n  width: 70%;\n\n  background: repeating-linear-gradient(\n    120deg,\n    ${(props) => props.theme.color.lightGrey},\n    ${(props) => props.theme.color.lightGrey} 5px,\n    ${(props) => props.theme.color.white} 5px,\n    ${(props) => props.theme.color.white} 6px\n  );\n  background-size: 250px;\n  animation: moveIt 10s linear infinite;\n`;\n\nconst Loading = ({isLoading}: {isLoading: boolean}) => {\n  return (\n    <Container>\n      {isLoading && (\n        <Bar>\n          <Progress />\n        </Bar>\n      )}\n    </Container>\n  );\n};\n\nexport {Loading, Bar, Progress};\n","const AMPLITUDE_URL = 'https://api.amplitude.com/2/httpapi';\n\nconst uuidv4 = () => {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n    var r = (Math.random() * 16) | 0,\n      v = c === 'x' ? r : (r & 0x3) | 0x8;\n    return v.toString(16);\n  });\n};\n\nenum UserEvent {\n  AppLaunch = 'app_launch_event',\n  ErrorOccured = 'error_occured_event',\n  StartAdding = 'start_adding_event',\n  StartEditing = 'start_editing_event',\n  GifSelected = 'gif_selected_event',\n  CancelAdd = 'cancel_add_event',\n  LoopAdded = 'loop_added_event',\n  LoopEdited = 'loop_edited_event',\n  LoopRemoved = 'loop_removed_event',\n  Download = 'download_event',\n  OpenWtf = 'open_wtf_event',\n  CloseWtf = 'close_wtf_event',\n  OpenLike = 'open_like_event',\n  CloseLike = 'close_like_event',\n  ConfigurationChange = 'configuration_change_event',\n}\n\n// Everytime you relaunch the app, I generate a unique id from nothing to identifiy a session.\nconst sessionId = Date.now();\nlet userId: null | string = null;\n\nconst getUserId = () => {\n  if (null === userId) {\n    if (null === localStorage.getItem('user_id')) {\n      userId = uuidv4();\n      localStorage.setItem('user_id', userId);\n    } else {\n      userId = localStorage.getItem('user_id');\n    }\n  }\n\n  return userId;\n};\n\nconst sendError = (type: string, error: Error) => {\n  console.error(type, error);\n  sendEvent(UserEvent.ErrorOccured, {type: type, error});\n};\n\nconst sendEvent = async (type: string, event: any = {}) => {\n  if ('development' === process.env.NODE_ENV) {\n    console.log(type, event);\n    return;\n  }\n\n  try {\n    await fetch(AMPLITUDE_URL, {\n      method: 'POST',\n      mode: 'cors',\n      cache: 'no-cache',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        api_key: process.env.REACT_APP_ANALYTICS_API_KEY,\n        events: [\n          {\n            user_id: getUserId(),\n            session_id: sessionId,\n            device_id: getUserId(),\n            event_type: type,\n            time: Date.now(),\n            event_properties: event,\n            app_version: process.env.REACT_APP_VERSION,\n          },\n        ],\n      }),\n    });\n  } catch {}\n};\n\nexport {sendEvent, sendError, UserEvent};\n","import React, {useRef, useEffect} from 'react';\nimport styled from 'styled-components';\nimport {FRAME_WIDTH, FRAME_HEIGHT, animate} from '../tools/canvas';\nimport {Preview} from '../model/loop';\n\nconst Canvas = styled.canvas<{cssWidth: number}>`\n  width: ${(props) => props.cssWidth}px;\n  height: ${(props) => (props.cssWidth / FRAME_WIDTH) * FRAME_HEIGHT}px;\n`;\n\nconst Player = ({width, preview}: {preview: Preview; width: number}) => {\n  const canvasRef = useRef(null);\n\n  useEffect(() => {\n    if (null !== canvasRef && null !== canvasRef.current && 0 !== preview.length) {\n      const timer = animate(canvasRef.current as any, preview);\n\n      return () => {\n        clearInterval(timer);\n      };\n    }\n  }, [preview]);\n\n  return <Canvas ref={canvasRef} width={FRAME_WIDTH} height={FRAME_HEIGHT} cssWidth={width}></Canvas>;\n};\n\nexport {Player};\n","import SuperGif from 'libgif';\n\nexport enum Sample {\n  Trim = 'trim',\n  Sample = 'sample',\n}\n\nexport type Frame = {data: ImageData; delay: number};\nexport type GIF = Frame[];\nexport type Configuration = {\n  mode: Sample;\n  start: number;\n  end: number;\n};\n\nconst blockedProviders = ['media.gifs.nl'];\n\nconst getBase64 = async (file: File): Promise<string> => {\n  return new Promise((resolve) => {\n    var reader = new FileReader();\n\n    reader.onload = function (event: any) {\n      resolve(event.target.result);\n    };\n\n    reader.readAsDataURL(file);\n  });\n};\nconst getImage = async (url: string): Promise<HTMLImageElement> => {\n  return new Promise((resolve) => {\n    var image = new Image();\n\n    image.onload = function (event: any) {\n      resolve(image);\n    };\n\n    image.src = url;\n  });\n};\n\nconst getGifLength = (gif: GIF): number => {\n  if (0 === gif.length) return 0;\n\n  return gif.reduce((result, frame) => result + frame.delay, 0) * 10;\n};\n\nconst getFrameLength = (gif: GIF): number => {\n  if (0 === gif.length) return 0;\n\n  return getGifLength(gif) / gif.length;\n};\n\nconst getDataUrl = async (url: string): Promise<string> => {\n  return new Promise((resolve, reject) => {\n    var xhr = new XMLHttpRequest();\n    xhr.onload = function () {\n      if ('image/gif' !== xhr.response.type) {\n        reject(`Url \"${url}\" does not lead to a gif file`);\n      }\n\n      var reader = new FileReader();\n      reader.onloadend = function () {\n        if (null === reader.result) {\n          reject(`Cannot read file for url \"${url}\"`);\n        }\n\n        resolve(reader.result as string);\n      };\n      reader.readAsDataURL(xhr.response);\n    };\n    xhr.onerror = (error) => {\n      if (blockedProviders.some((provider) => -1 !== url.indexOf(provider))) {\n        reject(\n          `The provider \"${blockedProviders.find(\n            (provider) => -1 !== url.indexOf(provider)\n          )}\" does not allow to download gifs from external tools.\n          It's not ideal but you can download the gif yourself and import it using the file section below `\n        );\n      } else if (0 === url.indexOf('file://')) {\n        reject(\n          `It's not possible to import files from local filesystem as an URL, please import it using the file section below `\n        );\n      }\n    };\n    xhr.open('GET', url);\n    xhr.responseType = 'blob';\n    xhr.send();\n  });\n};\n\nconst getSuperGif = async (image: HTMLImageElement): Promise<any> => {\n  return new Promise((resolve) => {\n    var superGif = new SuperGif({gif: image, auto_play: false});\n    superGif.load(() => {\n      resolve(superGif);\n    });\n  });\n};\n\nconst getGif = async (urlData: string): Promise<GIF> => {\n  const image = await getImage(urlData);\n  const parent = document.createElement('div');\n  parent.appendChild(image);\n\n  const gif = (await getSuperGif(image)).get_frames();\n\n  return gif.map((frame: Frame) => (frame.delay === null || frame.delay === 0 ? {...frame, delay: 1} : frame));\n};\n\nexport {getGif, getImage, getBase64, getDataUrl, getGifLength, getFrameLength};\n","import React, {useState, useEffect, useCallback, useContext} from 'react';\nimport {GIF, Configuration} from '../../tools/gif';\nimport styled from 'styled-components';\nimport {SourceSelector} from './Adder/SourceSelector';\nimport {LoopConfigurator} from './Adder/LoopConfigurator';\nimport {SpriteSelector} from './Adder/SpriteSelector';\nimport {Loop, EmptyLoop, isLoop, updatePreview, Preview} from '../../model/loop';\nimport {useBooleanState} from '../../hooks/boolean';\nimport {sendEvent, UserEvent} from '../../tools/analytics';\nimport {Container, Modal, Header, Dismiss, Title, Mask} from '../Modal';\nimport {useShortcut} from '../../hooks/shortcut';\nimport {Key} from '../../tools/key';\nimport {Loading} from '../Loading';\nimport {LoadingContext} from '../../context/loading';\n\nconst Scroller = styled.div<{level: number}>`\n  width: ${(props) => props.theme.addModal.windowSize * 3}px;\n  display: flex;\n  transform: translate3d(\n    -${(props) => props.level * (props.theme.addModal.windowSize - props.theme.addModal.spacing)}px,\n    0,\n    0\n  );\n  transition: transform 0.5s ease-in-out;\n`;\n\nconst getLevel = (loop: Loop | EmptyLoop, isEdit: boolean): number => {\n  if (isEdit) return 0;\n  if (null !== loop.configuration && null === loop.sprite) return 2;\n  if (0 !== loop.gif.length) return 1;\n\n  return 0;\n};\n\nconst Adder = ({\n  initialLoop,\n  onLoopAdd,\n  dismissModal,\n}: {\n  initialLoop: Loop | EmptyLoop;\n  onLoopAdd: (loop: Loop) => void;\n  dismissModal: () => void;\n}) => {\n  const isEdit = isLoop(initialLoop);\n  const [isConfirmed, setComfirmed] = useState(!isEdit);\n  const [loop, setLoop] = useState<Loop | EmptyLoop>(initialLoop);\n  const [isVisible, show] = useBooleanState(false);\n  const [loading, setLoading] = useContext(LoadingContext);\n\n  useEffect(() => {\n    setImmediate(() => show());\n    // eslint-disable-next-line\n  }, []);\n\n  useEffect(() => {\n    if (isLoop(loop) && isConfirmed) {\n      onLoopAdd(0 === loop.preview.length ? updatePreview(loop) : loop);\n    }\n  }, [loop, onLoopAdd, isConfirmed, setLoading]);\n\n  const dismiss = useCallback(() => {\n    if (null !== loop.configuration) {\n      sendEvent(UserEvent.CancelAdd, {from: 'sprite'});\n    } else if (0 !== loop.gif.length) {\n      sendEvent(UserEvent.CancelAdd, {from: 'configure'});\n    } else {\n      sendEvent(UserEvent.CancelAdd, {from: 'start'});\n    }\n\n    dismissModal();\n  }, [dismissModal, loop]);\n\n  useShortcut(Key.Escape, dismiss);\n\n  return (\n    <Container isVisible={isVisible} data-testid=\"adder_modal\">\n      <Mask onClick={dismiss} />\n      <Modal>\n        <Header>\n          <Dismiss onClick={dismiss}>X</Dismiss>\n          <Title>{`${isEdit ? 'Edit' : 'Add'} a loop`}</Title>\n          <Loading isLoading={loading} />\n        </Header>\n        <Scroller level={getLevel(loop, isEdit)}>\n          {!isEdit && (\n            <SourceSelector\n              previous={0 !== loop.gif.length}\n              onGifSelected={(gif: GIF) => {\n                if (0 === gif.length) {\n                  setLoop(initialLoop);\n                } else {\n                  setLoop({...loop, gif});\n                }\n              }}\n            />\n          )}\n          <LoopConfigurator\n            isEdit={isEdit}\n            gif={loop.gif}\n            initialConfiguration={loop.configuration}\n            onLoopConfirmation={(configuration: Configuration | null, preview: Preview) => {\n              setLoop({...loop, configuration, preview});\n              setComfirmed(true);\n            }}\n          />\n          <SpriteSelector\n            onSpriteConfirmation={(sprite: number) => {\n              setLoop({...loop, sprite});\n            }}\n          />\n        </Scroller>\n      </Modal>\n    </Container>\n  );\n};\n\nexport {Adder};\n","import React from 'react';\nimport styled from 'styled-components';\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  width: ${(props) => props.theme.addModal.windowSize - props.theme.addModal.spacing}px;\n  height: ${(props) => props.theme.addModal.windowSize}px;\n  padding: ${(props) => props.theme.addModal.spacing}px;\n  background: ${(props) => props.theme.color.black};\n  box-sizing: border-box;\n  justify-content: center;\n  display: flex;\n`;\n\nconst Grid = styled.div`\n  display: grid;\n  grid-gap: 10px;\n  grid-template-columns: repeat(auto-fill, minmax(95px, 1fr));\n`;\n\nconst Sprite = styled.div`\n  width: 95px;\n  margin-right: 10px;\n  height: 44px;\n  background: ${(props) => props.theme.color.white};\n  line-height: 44px;\n  text-align: center;\n  font-weight: 100;\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst SpriteSelector = ({onSpriteConfirmation}: {onSpriteConfirmation: (sprite: number) => void}) => {\n  return (\n    <Container>\n      <Grid>\n        {[...new Array(14)].map((_content, index: number) => (\n          <Sprite\n            key={index}\n            onClick={() => {\n              onSpriteConfirmation(index);\n            }}\n          >\n            {index + 1}\n          </Sprite>\n        ))}\n      </Grid>\n    </Container>\n  );\n};\n\nexport {SpriteSelector};\n","import React, {useEffect} from 'react';\nimport {useBooleanState} from '../hooks/boolean';\nimport {Container, Modal, Header, Dismiss, Title, Mask} from './Modal';\nimport styled from 'styled-components';\nimport {useShortcut} from '../hooks/shortcut';\nimport {Key} from '../tools/key';\n\nconst Content = styled.div`\n  padding: 15px 50px 30px 50px;\n  line-height: 23px;\n`;\n\nconst Version = styled.div`\n  text-align: center;\n  font-size: 11px;\n`;\n\nconst Wtf = ({dismissModal}: {dismissModal: () => void}) => {\n  const [isVisible, show] = useBooleanState(false);\n\n  useEffect(() => {\n    setImmediate(() => show());\n  }, [show]);\n\n  useShortcut(Key.Escape, dismissModal);\n\n  return (\n    <Container isVisible={isVisible} data-testid=\"wtf_modal\">\n      <Mask onClick={dismissModal} />\n      <Modal>\n        <Header>\n          <Dismiss onClick={dismissModal}>X</Dismiss>\n          <Title>What the **** is this?</Title>\n        </Header>\n        <Content>\n          <h2>Hey! Nice to meet you, glad you asked!</h2>\n          <p>\n            This web application is here to ease the generation of sprites for the{' '}\n            <a href=\"https://www.synthpaks.com/products/gif-looper-template-project-beta\">awesome gif looper</a>. <br />\n          </p>\n          <h2>How it works?</h2>\n          <div>\n            <ul>\n              <li>Select one of the 14 slots or click on the \"Add\" button</li>\n              <li>Select a GIF (from an URL or a file)</li>\n              <li>\n                Once you have filled all of the 14 slots (or before if you don't wan't to use them all), click on the\n                download button.\n              </li>\n            </ul>\n            This will generate your sprites in the expected format.\n          </div>\n          <p>\n            For the rest of the process, you can refer to the official documentation of{' '}\n            <a href=\"https://www.synthpaks.com/products/gif-looper-template-project-beta\">gif looper</a>.\n          </p>\n          <h2>Well, that's nice, but it doesn't seems to work</h2>\n          <p>\n            Wow, I'm really sorry to hear that, I hope that you didn't loose any work. Don't hesistate to open an issue{' '}\n            <a href=\"https://github.com/juliensnz/opz-gif/issues\">here</a> or send me a{' '}\n            <a href=\"https://twitter.com/juliensnz\">tweet</a> to see if I can fix it. Or even better: as this is an{' '}\n            <a href=\"https://github.com/juliensnz/opz-gif\">open source project</a>, you maybe can fix it yourself!\n          </p>\n          <Version>v{process.env.REACT_APP_VERSION}</Version>\n        </Content>\n      </Modal>\n    </Container>\n  );\n};\n\nexport {Wtf};\n","import React, {useEffect} from 'react';\nimport {useBooleanState} from '../hooks/boolean';\nimport {Container, Modal, Header, Dismiss, Title, Mask} from './Modal';\nimport styled from 'styled-components';\nimport {useShortcut} from '../hooks/shortcut';\nimport {Key} from '../tools/key';\n\nconst Content = styled.div`\n  padding: 20px 50px;\n  line-height: 23px;\n`;\nconst Donate = styled.input`\n  width: 110px;\n`;\nconst Form = styled.form`\n  display: flex;\n  justify-content: center;\n`;\n\nconst Like = ({dismissModal}: {dismissModal: () => void}) => {\n  const [isVisible, show] = useBooleanState(false);\n\n  useEffect(() => {\n    setImmediate(() => show());\n  }, [show]);\n  useShortcut(Key.Escape, dismissModal);\n\n  return (\n    <Container isVisible={isVisible} data-testid=\"like_modal\">\n      <Mask onClick={dismissModal} />\n      <Modal>\n        <Header>\n          <Dismiss\n            onClick={() => {\n              dismissModal();\n            }}\n          >\n            X\n          </Dismiss>\n          <Title>I like it!</Title>\n        </Header>\n        <Content>\n          <p>Really nice of you, I'm glad you enjoy it :)</p>\n          <h2>But why dude?</h2>\n          <p>\n            I'm a big fan of my OP-Z and wanted to play with the Motion track a bit. I found the{' '}\n            <a href=\"https://www.synthpaks.com/products/gif-looper-template-project-beta\">gif looper</a> project but\n            didn't want to generate sprites by hand. So here is why.\n          </p>\n          <h2>Is it free?</h2>\n          <p>\n            Yes! This project is <a href=\"https://github.com/juliensnz/opz-gif\">open source</a>, you can use this\n            project for free, enjoy it as much as you want and even{' '}\n            <a href=\"https://support.google.com/chrome/answer/9658361?co=GENIE.Platform%3DDesktop&hl=en\">\n              install it locally\n            </a>{' '}\n            to use it offline.\n          </p>\n          <h2>How can I help?</h2>\n          <p>\n            As this project is <a href=\"https://github.com/juliensnz/opz-gif\">open source</a>, you can make suggestions\n            for improvement <a href=\"https://github.com/juliensnz/opz-gif/issues\">here</a> or even{' '}\n            <a href=\"https://github.com/juliensnz/opz-gif\">contribute to the project</a>.\n            <br />\n            <br />\n            If you still want to support me and my work, you can make a donation using the button down bellow.\n          </p>\n          <Form action=\"https://www.paypal.com/cgi-bin/webscr\" method=\"post\" target=\"_top\">\n            <input type=\"hidden\" name=\"cmd\" value=\"_donations\" />\n            <input type=\"hidden\" name=\"business\" value=\"KWM3S8MMH8BNU\" />\n            <input type=\"hidden\" name=\"currency_code\" value=\"EUR\" />\n            <Donate\n              type=\"image\"\n              src=\"https://juliensnz.github.io/opz-gif/donate.png\"\n              name=\"submit\"\n              title=\"PayPal - The safer, easier way to pay online!\"\n              alt=\"Donate with PayPal button\"\n            />\n            <img alt=\"\" src=\"https://www.paypal.com/en_FR/i/scr/pixel.gif\" width=\"1\" height=\"1\" />\n          </Form>\n        </Content>\n      </Modal>\n    </Container>\n  );\n};\n\nexport {Like};\n","import {RefObject, useCallback, useEffect} from 'react';\n\nconst useAutoFocus = (ref: RefObject<HTMLInputElement>): (() => void) => {\n  const focus = useCallback(() => {\n    if (ref.current !== null) ref.current.focus();\n  }, [ref]);\n\n  useEffect(focus, []);\n\n  return focus;\n};\n\nexport {useAutoFocus};\n","import {useRef, useEffect} from 'react';\n\nconst useMounted = (beforeUnmount: () => void = () => {}): (() => boolean) => {\n  const isMountedRef = useRef(true);\n  useEffect(() => {\n    return () => {\n      beforeUnmount();\n      isMountedRef.current = false;\n    };\n    // eslint-disable-next-line\n  }, []);\n\n  return () => isMountedRef.current;\n};\n\nexport {useMounted};\n","import React, {ChangeEvent, useState, useRef, useEffect, KeyboardEvent, useCallback, useContext} from 'react';\nimport styled from 'styled-components';\nimport {getDataUrl, getGif, GIF} from '../../../../tools/gif';\nimport {Back} from '../../../Style/Back';\nimport {Source} from '../SourceSelector';\nimport {useAutoFocus} from '../../../../hooks/focus';\nimport {sendEvent, UserEvent, sendError} from '../../../../tools/analytics';\nimport {LoadingContext} from '../../../../context/loading';\nimport {useMounted} from '../../../../hooks/mounted';\n\nconst Container = styled.div<{selected: boolean; previous: boolean}>`\n  background-color: ${(props) => props.theme.color.yellow};\n  width: ${(props) => props.theme.addModal.windowSize}px;\n  height: ${(props) =>\n    props.selected\n      ? props.theme.addModal.windowSize - (props.previous ? 0 : props.theme.addModal.spacing)\n      : props.theme.addModal.windowSize / props.theme.addModal.sourceCount}px;\n  transition: height 0.5s ease-in-out;\n  flex-direction: column;\n  position: relative;\n`;\n\nconst Button = styled.div`\n  width: ${(props) => props.theme.addModal.windowSize}px;\n  height: ${(props) => props.theme.addModal.windowSize / props.theme.addModal.sourceCount}px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  font-size: 30px;\n  font-weight: 200;\n  color: white;\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst Form = styled.div<{visible: boolean}>`\n  display: flex;\n  flex-direction: column;\n  padding: 0 60px;\n  opacity: ${(props) => (props.visible ? 1 : 0)};\n  height: ${(props) => (props.visible ? props.theme.addModal.windowSize / props.theme.addModal.sourceCount : 0)};\n  transition: opacity 0.5s ease-in-out;\n`;\n\nconst Input = styled.input`\n  margin: 0 10px;\n  padding: 10px 5px;\n  font-size: 20px;\n  background: transparent;\n  border: 1px solid rgba(0, 0, 0, 0.3);\n`;\nconst Submit = styled.span`\n  background: ${(props) => props.theme.color.white};\n  color: black;\n  margin: 10px 10px;\n  padding: 10px 5px;\n  font-size: 20px;\n  text-align: center;\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\nconst ErrorDisplay = styled.span`\n  color: ${(props) => props.theme.color.red};\n  margin: 0 10px 10px 10px;\n  padding: 0 5px 10px 5px;\n  font-size: 15px;\n  text-align: left;\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst UrlSource = ({\n  selected,\n  previous,\n  onSelected,\n  onGifSelected,\n}: {\n  selected: Source | null;\n  previous: boolean;\n  onSelected: () => void;\n  onGifSelected: (gif: GIF) => void;\n}) => {\n  const [url, setUrl] = useState('');\n  const [loading, setLoading] = useContext(LoadingContext);\n  const isMounted = useMounted(() => setLoading(false));\n  const [error, setError] = useState<string | null>(null);\n\n  const urlRef = useRef<HTMLInputElement>(null);\n  const setFocus = useAutoFocus(urlRef);\n  useEffect(() => {\n    if (Source.Url === selected) {\n      setFocus();\n    }\n\n    if (null === selected) {\n      setTimeout(() => setUrl(''), 500);\n    }\n  }, [selected, previous, setFocus]);\n\n  const submit = useCallback(async () => {\n    if (true === loading) return;\n    setLoading(true);\n    setError(null);\n\n    try {\n      const gifData = await getDataUrl(url);\n      const newGif = await getGif(gifData);\n\n      if (!isMounted()) return;\n      setLoading(false);\n      sendEvent(UserEvent.GifSelected, {type: 'url'});\n      onGifSelected(newGif);\n    } catch (error) {\n      sendError('cannot_generate_gif_from_url', error);\n      setError(`Error: ${error}`);\n\n      if (!isMounted()) return;\n      setLoading(false);\n    }\n  }, [url, onGifSelected, setLoading, loading, isMounted]);\n\n  return (\n    <Container selected={Source.Url === selected} previous={previous}>\n      <Button data-testid=\"url_source_button\" onClick={() => Source.Url !== selected && onSelected()}>\n        Url\n      </Button>\n      <Form visible={Source.Url === selected}>\n        <Input\n          data-testid=\"url_source_input\"\n          ref={urlRef}\n          placeholder=\"Your GIF url\"\n          type=\"text\"\n          onChange={async (event: ChangeEvent<HTMLInputElement>) => {\n            setUrl(event.currentTarget.value);\n          }}\n          onKeyPress={(event: KeyboardEvent<HTMLInputElement>) => {\n            if ('Enter' === event.key) {\n              submit();\n            }\n          }}\n          value={url}\n        />\n        <Submit data-testid=\"url_source_confirm\" onClick={submit}>\n          Confirm\n        </Submit>\n        {null !== error && <ErrorDisplay>{error}</ErrorDisplay>}\n      </Form>\n      {previous && (\n        <Back vertical={true} onClick={() => onGifSelected([])}>\n          Back\n        </Back>\n      )}\n      {null !== selected && Source.Url !== selected && (\n        <Back vertical={false} leading={false} onClick={() => onSelected()}>\n          Back\n        </Back>\n      )}\n    </Container>\n  );\n};\n\nexport {UrlSource};\n","import React, {ChangeEvent, useContext, useCallback, useState} from 'react';\nimport styled from 'styled-components';\nimport {GIF, getBase64, getGif} from '../../../../tools/gif';\nimport {Back} from '../../../Style/Back';\nimport {Source} from '../SourceSelector';\nimport {sendEvent, UserEvent, sendError} from '../../../../tools/analytics';\nimport {LoadingContext} from '../../../../context/loading';\nimport {useMounted} from '../../../../hooks/mounted';\n\nconst Container = styled.div<{selected: boolean; previous: boolean}>`\n  background-color: ${(props) => props.theme.color.blue};\n  width: ${(props) => props.theme.addModal.windowSize}px;\n  height: ${(props) =>\n    props.selected\n      ? props.theme.addModal.windowSize - (props.previous ? 0 : props.theme.addModal.spacing * 2)\n      : props.theme.addModal.windowSize / props.theme.addModal.sourceCount}px;\n  transition: height 0.5s ease-in-out;\n  position: relative;\n`;\nconst Button = styled.div`\n  width: ${(props) => props.theme.addModal.windowSize}px;\n  height: ${(props) => props.theme.addModal.windowSize / props.theme.addModal.sourceCount}px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  font-size: 30px;\n  font-weight: 200;\n  color: white;\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst DropZone = styled.div<{visible: boolean}>`\n  width: ${(props) => props.theme.addModal.windowSize}px;\n  opacity: ${(props) => (props.visible ? 1 : 0)};\n  height: ${(props) => (props.visible ? props.theme.addModal.windowSize / props.theme.addModal.sourceCount : 0)}px;\n  transition: opacity 0.5s ease-in-out, transform 0.2s ease-in-out;\n  position: relative;\n\n  &:hover {\n    cursor: pointer;\n    transform: scale(1.02);\n  }\n`;\n\nconst Explanation = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: calc(100% - ${(props) => props.theme.addModal.spacing * 2}px);\n  height: calc(100%);\n  background-image: url(\"data:image/svg+xml,%3csvg width='100%25' height='100%25' xmlns='http://www.w3.org/2000/svg'%3e%3crect width='100%25' height='100%25' fill='none' rx='10' ry='10' stroke='%23E9B13DFF' stroke-width='4' stroke-dasharray='6%2c 14' stroke-dashoffset='0' stroke-linecap='square'/%3e%3c/svg%3e\");\n  border-radius: 10px;\n  margin: 0 ${(props) => props.theme.addModal.spacing}px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 20px;\n  font-weight: 200;\n  padding: 20px;\n  flex-direction: column;\n  box-sizing: border-box;\n`;\n\nconst ErrorDisplay = styled.span`\n  color: ${(props) => props.theme.color.white};\n  text-align: center;\n  margin-top: 20px;\n`;\nconst Input = styled.input`\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  opacity: 0;\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst FileSource = ({\n  selected,\n  previous,\n  onSelected,\n  onGifSelected,\n}: {\n  selected: Source | null;\n  previous: boolean;\n  onSelected: () => void;\n  onGifSelected: (gif: GIF) => void;\n}) => {\n  const [loading, setLoading] = useContext(LoadingContext);\n  const isMounted = useMounted(() => setLoading(false));\n  const [error, setError] = useState<string | null>(null);\n\n  const submit = useCallback(\n    async (event: ChangeEvent<HTMLInputElement>) => {\n      if (true === loading) return;\n      if (null === event.target.files) return;\n      if (undefined === event.target.files[0]) return;\n\n      if ('image/gif' !== event.target.files[0].type) {\n        const error = new Error(\n          `File type \"${event.target.files[0].type}\" are not supported yet. Only .gif files are supported for now.`\n        );\n        sendError('cannot_generate_gif_from_file', error);\n        setError(`Error: ${error.message}`);\n        return;\n      }\n      setLoading(true);\n\n      try {\n        const gifData = await getBase64(event.target.files[0]);\n        const newGif = await getGif(gifData);\n\n        if (!isMounted()) return;\n        setLoading(false);\n        sendEvent(UserEvent.GifSelected, {type: 'file'});\n        onGifSelected(newGif);\n      } catch (error) {\n        sendError('cannot_generate_gif_from_file', error);\n        setError(`Error: ${error}`);\n\n        if (!isMounted()) return;\n        setLoading(false);\n      }\n    },\n    [onGifSelected, setLoading, loading, isMounted]\n  );\n\n  return (\n    <Container selected={Source.File === selected} previous={previous}>\n      <Button data-testid=\"file_source_button\" onClick={() => Source.File !== selected && onSelected()}>\n        File\n      </Button>\n      {null !== selected && Source.File !== selected && (\n        <Back vertical={false} onClick={() => onSelected()}>\n          Back\n        </Back>\n      )}\n      <DropZone visible={Source.File === selected}>\n        <Explanation>\n          <span>Click here or directly drop your file</span>\n          {null !== error && <ErrorDisplay>{error}</ErrorDisplay>}\n        </Explanation>\n\n        <Input data-testid=\"file_source_input\" type=\"file\" onChange={submit} />\n      </DropZone>\n      {null !== selected && Source.File !== selected && (\n        <Back vertical={false} leading={false} onClick={() => onSelected()}>\n          Back\n        </Back>\n      )}\n\n      {previous && (\n        <Back vertical={true} onClick={() => onGifSelected([])}>\n          Back\n        </Back>\n      )}\n    </Container>\n  );\n};\n\nexport {FileSource};\n","import React, {\n  ChangeEvent,\n  useContext,\n  useCallback,\n  useState,\n  useRef,\n  useEffect,\n  KeyboardEvent,\n  SyntheticEvent,\n} from 'react';\nimport styled from 'styled-components';\nimport {GIF, getGif, getDataUrl} from '../../../../tools/gif';\nimport {Back} from '../../../Style/Back';\nimport {Source} from '../SourceSelector';\nimport {sendEvent, UserEvent, sendError} from '../../../../tools/analytics';\nimport {LoadingContext} from '../../../../context/loading';\nimport {useMounted} from '../../../../hooks/mounted';\nimport {Grid} from '@giphy/react-components';\nimport {GiphyFetch} from '@giphy/js-fetch-api';\nimport {useAutoFocus} from '../../../../hooks/focus';\n\nconst gf = new GiphyFetch(process.env.REACT_APP_GIPHY_API_KEY);\n\nconst Container = styled.div<{selected: boolean; previous: boolean}>`\n  background-color: ${(props) => props.theme.color.red};\n  width: ${(props) => props.theme.addModal.windowSize}px;\n  height: ${(props) =>\n    props.selected\n      ? props.theme.addModal.windowSize - (props.previous ? 0 : props.theme.addModal.spacing)\n      : props.theme.addModal.windowSize / props.theme.addModal.sourceCount}px;\n  transition: height 0.5s ease-in-out;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n`;\nconst Button = styled.div<{selected: boolean}>`\n  width: ${(props) => props.theme.addModal.windowSize}px;\n  height: ${(props) =>\n    props.selected\n      ? props.theme.addModal.spacing\n      : props.theme.addModal.windowSize / props.theme.addModal.sourceCount}px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  font-size: 30px;\n  font-weight: 200;\n  flex-shrink: 0;\n  color: white;\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\nconst ErrorDisplay = styled.span`\n  color: ${(props) => props.theme.color.white};\n  text-align: center;\n  margin-top: 20px;\n`;\n\nconst SelectionZone = styled.div<{visible: boolean}>`\n  width: ${(props) => props.theme.addModal.windowSize}px;\n  opacity: ${(props) => (props.visible ? 1 : 0)};\n  height: ${(props) => (props.visible ? props.theme.addModal.windowSize - 2 * props.theme.addModal.spacing : 0)}px;\n  transition: opacity 0.5s ease-in-out, transform 0.2s ease-in-out;\n  position: relative;\n  flex: 1;\n  padding: 0 60px;\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  overflow: auto;\n`;\nconst Form = styled.div<{visible: boolean}>`\n  display: flex;\n  opacity: ${(props) => (props.visible ? 1 : 0)};\n  height: ${(props) => (props.visible ? props.theme.addModal.windowSize / props.theme.addModal.sourceCount : 0)};\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  box-shadow: 0 10px 0 ${(props) => props.theme.color.red};\n  background: ${(props) => props.theme.color.red};\n  margin-bottom: 10px;\n`;\n\nconst Input = styled.input`\n  padding: 10px 5px;\n  font-size: 20px;\n  background: transparent;\n  border: 1px solid rgba(0, 0, 0, 0.3);\n  flex: 1;\n  outline-style: none;\n`;\nconst Submit = styled.span`\n  background: ${(props) => props.theme.color.white};\n  color: black;\n  padding: 10px 20px;\n  font-size: 20px;\n  text-align: center;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst PoweredContainer = styled.div`\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  justify-content: flex-end;\n  padding: 60px 0;\n`;\n\nconst PoweredLogo = styled.img`\n  width: 200px;\n`;\n\nconst GiphySource = ({\n  selected,\n  previous,\n  onSelected,\n  onGifSelected,\n}: {\n  selected: Source | null;\n  previous: boolean;\n  onSelected: () => void;\n  onGifSelected: (gif: GIF) => void;\n}) => {\n  const [search, setSearch] = useState('');\n  const [currentSearch, setCurrentSearch] = useState('');\n  const [loading, setLoading] = useContext(LoadingContext);\n  const isMounted = useMounted(() => setLoading(false));\n  const [error, setError] = useState<string | null>(null);\n  const searchRef = useRef<HTMLInputElement>(null);\n  const setFocus = useAutoFocus(searchRef);\n  useEffect(() => {\n    if (Source.Giphy === selected) {\n      setFocus();\n    }\n\n    if (null === selected) {\n      setTimeout(() => setSearch(''), 500);\n    }\n  }, [selected, previous, setFocus]);\n\n  const fetchGifs = useCallback(\n    (offset: number) => {\n      return gf.search(search, {sort: 'relevant', lang: 'en', limit: 200, type: 'gifs'});\n    },\n    [search]\n  );\n\n  const submit = useCallback(\n    async (url) => {\n      if (true === loading) return;\n      setLoading(true);\n      setError(null);\n\n      try {\n        const gifData = await getDataUrl(url);\n        const newGif = await getGif(gifData);\n\n        if (!isMounted()) return;\n        setLoading(false);\n        sendEvent(UserEvent.GifSelected, {type: 'giphy'});\n        onGifSelected(newGif);\n      } catch (error) {\n        sendError('cannot_generate_gif_from_giphy', error);\n        setError(`Error: ${error}`);\n\n        if (!isMounted()) return;\n        setLoading(false);\n      }\n    },\n    [onGifSelected, setLoading, loading, isMounted]\n  );\n\n  const doSearch = useCallback(() => {\n    setCurrentSearch(search);\n  }, [search]);\n\n  return (\n    <Container selected={Source.Giphy === selected} previous={previous}>\n      <Button selected={Source.Giphy === selected} onClick={() => Source.Giphy !== selected && onSelected()}>\n        Giphy\n      </Button>\n      {null !== selected && Source.Giphy !== selected && (\n        <Back vertical={false} onClick={() => onSelected()}>\n          Back\n        </Back>\n      )}\n\n      <SelectionZone visible={Source.Giphy === selected}>\n        <Form visible={Source.Giphy === selected}>\n          <Input\n            ref={searchRef}\n            placeholder=\"Your search\"\n            type=\"text\"\n            onChange={async (event: ChangeEvent<HTMLInputElement>) => {\n              setSearch(event.currentTarget.value);\n              setCurrentSearch('');\n            }}\n            onKeyPress={(event: KeyboardEvent<HTMLInputElement>) => {\n              if ('Enter' === event.key) {\n                doSearch();\n              }\n            }}\n            value={search}\n          />\n          <Submit onClick={doSearch}>Search</Submit>\n          {null !== error && <ErrorDisplay>{error}</ErrorDisplay>}\n        </Form>\n        {'' !== search && search === currentSearch ? (\n          <Grid\n            width={480}\n            columns={3}\n            fetchGifs={fetchGifs}\n            hideAttribution={true}\n            onGifClick={(gif: any, event: SyntheticEvent<HTMLElement, Event>) => {\n              submit(gif.images.original.url);\n              event.preventDefault();\n              return false;\n            }}\n          />\n        ) : (\n          <PoweredContainer>\n            <PoweredLogo src=\"./PoweredByGiphy.png\" />\n          </PoweredContainer>\n        )}\n      </SelectionZone>\n\n      {previous && (\n        <Back vertical={true} onClick={() => onGifSelected([])}>\n          Back\n        </Back>\n      )}\n    </Container>\n  );\n};\n\nexport {GiphySource};\n","import React, {useState} from 'react';\nimport {GIF} from '../../../tools/gif';\nimport styled from 'styled-components';\nimport {UrlSource} from './SourceSelector/UrlSource';\nimport {FileSource} from './SourceSelector/FileSource';\nimport {GiphySource} from './SourceSelector/GiphySource';\n\nenum Source {\n  Url,\n  File,\n  Giphy,\n}\n\nconst getTranslation = (source: Source | null, previous: boolean, theme: any) => {\n  switch (source) {\n    case Source.File:\n      return theme.addModal.windowSize / theme.addModal.sourceCount - (!previous ? theme.addModal.spacing : 0);\n    case Source.Giphy:\n      return 2 * (theme.addModal.windowSize / theme.addModal.sourceCount) - (!previous ? theme.addModal.spacing : 0);\n    case Source.Url:\n      return 0;\n\n    default:\n      return 0;\n  }\n};\n\nconst Container = styled.div<{source: Source | null; previous: boolean}>`\n  width: ${(props) => props.theme.addModal.windowSize}px;\n  overflow: hidden;\n  transform: translate3d(0, -${(props) => getTranslation(props.source, props.previous, props.theme)}px, 0);\n  transition: all 0.5s ease-in-out;\n`;\n\nconst SourceSelector = ({onGifSelected, previous}: {previous: boolean; onGifSelected: (gif: GIF) => void}) => {\n  const [source, setSource] = useState<null | Source>(null);\n\n  return (\n    <Container source={source} previous={previous}>\n      <UrlSource\n        onSelected={() => {\n          setSource(null === source ? Source.Url : null);\n        }}\n        selected={source}\n        previous={previous}\n        onGifSelected={onGifSelected}\n      />\n      <FileSource\n        onSelected={() => {\n          setSource(null === source ? Source.File : null);\n        }}\n        selected={source}\n        previous={previous}\n        onGifSelected={onGifSelected}\n      />\n      <GiphySource\n        onSelected={() => {\n          setSource(null === source ? Source.Giphy : null);\n        }}\n        selected={source}\n        previous={previous}\n        onGifSelected={onGifSelected}\n      />\n    </Container>\n  );\n};\n\nexport {SourceSelector, Source};\n","import React, {useState, useEffect, useRef, useCallback} from 'react';\nimport styled from 'styled-components';\nimport {getTimeLabel} from './Cutter';\n\nenum HandlePosition {\n  Start,\n  End,\n}\nconst Grabber = styled.span`\n  width: 10px;\n  height: 20px;\n  border: 1px solid ${(props) => props.theme.color.grey};\n  background: repeating-linear-gradient(\n    120deg,\n    ${(props) => props.theme.color.grey},\n    ${(props) => props.theme.color.grey} 5px,\n    ${(props) => props.theme.color.white} 5px,\n    ${(props) => props.theme.color.white} 6px\n  );\n`;\nconst HandleGrabber = styled.div`\n  display: flex;\n  flex-direction: column;\n  margin-left: 20px;\n  margin-bottom: 18px;\n`;\nconst Pin = styled.div`\n  background: ${(props) => props.theme.color.grey};\n  width: 1px;\n  height: 5px;\n`;\nconst Container = styled.div`\n  display: flex;\n  position: absolute;\n  top: 0;\n  display: flex;\n  align-items: center;\n  ${Grabber} {\n    border-bottom-right-radius: 5px;\n    border-bottom-left-radius: 5px;\n  }\n  &:hover {\n    cursor: grab;\n  }\n  &:active {\n    cursor: grabbing;\n  }\n`;\nconst StartHandle = styled(Container)`\n  ${Grabber} {\n    border-top-right-radius: 5px;\n  }\n  ${HandleGrabber} {\n    align-items: flex-start;\n  }\n`;\nconst EndHandle = styled(Container)`\n  position: relative;\n  ${Grabber} {\n    border-top-left-radius: 5px;\n  }\n  ${HandleGrabber} {\n    align-items: flex-end;\n  }\n`;\nconst HandleTime = styled.span`\n  margin-left: 3px;\n  position: relative;\n  top: -7px;\n`;\n\nconst Handle = ({\n  handlePosition,\n  min,\n  max,\n  value,\n  length,\n  onChange,\n  onEnd,\n}: {\n  handlePosition: HandlePosition;\n  min: number;\n  max: number;\n  value: number;\n  length: number;\n  onChange: (newValue: number) => void;\n  onEnd: () => void;\n}) => {\n  const Element = handlePosition === HandlePosition.Start ? StartHandle : EndHandle;\n  const [parentWidth, setParentWidth] = useState<number>(0);\n  const [currentPosition, setCurrentPosition] = useState<number>((value / length) * parentWidth);\n  useEffect(() => {\n    setCurrentPosition((value / length) * parentWidth);\n  }, [value, parentWidth, length]);\n\n  const [grabberStartX, setGrabberStartX] = useState<number>(0);\n  const [startingPosition, setStartingPosition] = useState<number>(0);\n  const [isDragged, setIsDragged] = useState<boolean>(false);\n\n  const containerRef = useRef(null);\n  useEffect(() => {\n    setIsDragged(false);\n    null !== containerRef.current &&\n      (containerRef.current as any).parentNode &&\n      setParentWidth((containerRef.current as any).parentNode.getBoundingClientRect().width);\n  }, []);\n\n  const mouseUp = useCallback(\n    (event: any) => {\n      event.preventDefault();\n      setIsDragged(false);\n      onEnd();\n    },\n    [onEnd]\n  );\n\n  useEffect(() => {\n    if (isDragged) window.addEventListener('mouseup', mouseUp);\n\n    return () => window.removeEventListener('mouseup', mouseUp);\n  }, [isDragged, onEnd, mouseUp]);\n\n  const mouseDown = useCallback(\n    (event: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n      event.preventDefault();\n      setGrabberStartX(event.clientX);\n      setIsDragged(true);\n      setStartingPosition(Math.round(currentPosition));\n    },\n    [setIsDragged, setGrabberStartX, currentPosition]\n  );\n\n  const mouseMove = useCallback(\n    (event) => {\n      event.preventDefault();\n      if (isDragged) {\n        const newPosition = Math.round(startingPosition + event.clientX - grabberStartX);\n        const newValue = Math.round((newPosition / parentWidth) * length);\n\n        if (newValue > max + 1) {\n          onChange(max);\n          return;\n        } else if (newValue < min - 1) {\n          onChange(min);\n          return;\n        }\n\n        setCurrentPosition(newPosition);\n        onChange(newValue);\n      }\n    },\n    [isDragged, startingPosition, grabberStartX, length, max, min, onChange, parentWidth]\n  );\n\n  return (\n    <Element\n      ref={containerRef}\n      style={{left: `${handlePosition === HandlePosition.Start ? currentPosition - 20 : currentPosition - 32}px`}}\n      onMouseDown={mouseDown}\n      onMouseMove={mouseMove}\n    >\n      <HandleGrabber>\n        <Pin />\n        <Grabber />\n      </HandleGrabber>\n      <HandleTime>{getTimeLabel(value)}</HandleTime>\n    </Element>\n  );\n};\n\nexport {Handle, HandlePosition};\n","import React, {useCallback, useEffect, useState} from 'react';\nimport styled from 'styled-components';\nimport {Sample, GIF, getFrameLength} from '../../../../tools/gif';\nimport {Handle, HandlePosition} from './Handle';\n\nconst Container = styled.div`\n  width: 100%;\n`;\n\nconst Timeline = styled.div`\n  width: 100%;\n  display: flex;\n  height: 20px;\n  background-color: ${(props) => props.theme.color.grey};\n`;\n\nconst Timing = styled.div`\n  display: flex;\n  font-size: 12px;\n`;\nconst Spacer = styled.div`\n  flex: 1;\n`;\n\nconst CutBoard = styled.div`\n  position: relative;\n  font-size: 12px;\n`;\n\nconst Start = styled.div`\n  position: relative;\n  width: 40px;\n  left: -20px;\n  text-align: center;\n`;\nconst End = styled.div`\n  position: relative;\n  width: 40px;\n  right: -20px;\n  text-align: center;\n`;\nconst Trim = styled.div`\n  height: 100%;\n`;\nconst TrimStart = styled(Trim)`\n  background: repeating-linear-gradient(\n    120deg,\n    rgba(0, 0, 0, 0.1),\n    rgba(0, 0, 0, 0.1) 5px,\n    ${(props) => props.theme.color.grey} 5px,\n    ${(props) => props.theme.color.grey} 6px\n  );\n`;\n\nconst TrimEnd = styled(Trim)`\n  background: repeating-linear-gradient(\n    120deg,\n    rgba(0, 0, 0, 0.1),\n    rgba(0, 0, 0, 0.1) 5px,\n    ${(props) => props.theme.color.grey} 5px,\n    ${(props) => props.theme.color.grey} 6px\n  );\n  background-position-x: right;\n`;\nconst TrimCenter = styled(Trim)``;\n\ntype CutterProps = {\n  length: number;\n  start: number;\n  end: number;\n  mode: Sample;\n  gif: GIF;\n  onChange: (start: number, end: number) => void;\n};\n\nconst getTimeLabel = (time: number): string => {\n  const label = (Math.round(time / 10) / 100).toString().replace('.', '\"');\n\n  return `${label}${label.includes('\"') ? '' : '\"'}`;\n};\n\nconst Cutter = ({length, start, end, mode, gif, onChange}: CutterProps) => {\n  const [state, setState] = useState({start, end});\n  useEffect(() => {\n    setState({start, end});\n  }, [start, end]);\n\n  const onStartChange = useCallback(\n    (newStart: number) => {\n      Sample.Sample === mode\n        ? setState({...state, start: newStart})\n        : setState({start: newStart, end: newStart + 2000});\n    },\n    [state, mode]\n  );\n  const onEndChange = useCallback(\n    (newEnd: number) => {\n      Sample.Sample === mode ? setState({...state, end: newEnd}) : setState({start: newEnd - 2000, end: newEnd});\n    },\n    [state, mode]\n  );\n  const onEnd = useCallback(() => {\n    onChange(state.start, state.end);\n  }, [state, onChange]);\n\n  return (\n    <Container>\n      <Timing>\n        <Start>{getTimeLabel(0)}</Start>\n        <Spacer />\n        <End>{getTimeLabel(length)}</End>\n      </Timing>\n      <Timeline>\n        <TrimStart style={{width: `${(state.start / length) * 100}%`}} />\n        <TrimCenter style={{width: `${((length - (state.start + length - state.end)) / length) * 100}%`}} />\n        <TrimEnd style={{width: `${((length - state.end) / length) * 100}%`}} />\n      </Timeline>\n      <CutBoard>\n        <Handle\n          value={state.start}\n          handlePosition={HandlePosition.Start}\n          min={0}\n          max={Sample.Sample === mode ? state.end - getFrameLength(gif) * 3 : length - 2000}\n          length={length}\n          onChange={onStartChange}\n          onEnd={onEnd}\n        />\n        <Handle\n          value={state.end}\n          handlePosition={HandlePosition.End}\n          min={Sample.Sample === mode ? state.start + getFrameLength(gif) * 3 : 2000}\n          max={length}\n          length={length}\n          onChange={onEndChange}\n          onEnd={onEnd}\n        />\n      </CutBoard>\n    </Container>\n  );\n};\n\nexport {Cutter, getTimeLabel};\n","import React from 'react';\nimport styled, {css} from 'styled-components';\nimport {Sample} from '../../../../tools/gif';\n\nconst Container = styled.div`\n  margin-top: 10px;\n  width: 100%;\n  height: 40px;\n  /* border: 1px solid ${(props) => props.theme.color.grey}; */\n  border-radius: 3px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  /* overflow: hidden; */\n`;\n\nconst Mode = styled.div<{selected: boolean}>`\n  flex: 1;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: ${(props) => props.theme.color.black};\n  border: 1px solid ${(props) => props.theme.color.grey};\n\n  ${(props) =>\n    props.selected\n      ? css`\n          background: ${(props) => props.theme.color.yellow};\n        `\n      : css``};\n\n  &:nth-child(1) {\n    border-bottom-left-radius: 3px;\n    border-top-left-radius: 3px;\n    border-right: none;\n  }\n  &:nth-child(2) {\n    border-bottom-right-radius: 3px;\n    border-top-right-radius: 3px;\n  }\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst SampleModeSelector = ({mode, onChange}: {mode: Sample; onChange: (newMode: Sample) => void}) => {\n  return (\n    <Container>\n      <Mode\n        data-testid=\"loop_configurator_sample_trim\"\n        selected={mode === Sample.Trim}\n        onClick={() => onChange(Sample.Trim)}\n      >\n        Trim\n      </Mode>\n      <Mode\n        data-testid=\"loop_configurator_sample_sample\"\n        selected={mode === Sample.Sample}\n        onClick={() => onChange(Sample.Sample)}\n      >\n        Sample\n      </Mode>\n    </Container>\n  );\n};\n\nexport {SampleModeSelector};\n","import React, {useContext, useState, useEffect, useCallback} from 'react';\nimport styled, {ThemeContext} from 'styled-components';\nimport {GIF, Sample, Configuration, getGifLength} from '../../../tools/gif';\nimport {Player} from '../../Player';\nimport {Back} from '../../Style/Back';\nimport {Cutter} from './LoopConfigurator/Cutter';\nimport {SampleModeSelector} from './LoopConfigurator/SampleModeSelector';\nimport {sendEvent, UserEvent} from '../../../tools/analytics';\nimport {getImages} from '../../../tools/canvas';\nimport {Preview} from '../../../model/loop';\nimport {Bar, Progress} from '../../Loading';\n\nconst Container = styled.div<{fullSize: boolean}>`\n  display: flex;\n  flex-direction: column;\n  width: ${(props) => props.theme.addModal.windowSize - (props.fullSize ? 0 : props.theme.addModal.spacing)}px;\n  height: ${(props) => props.theme.addModal.windowSize}px;\n  padding: ${(props) => props.theme.addModal.spacing}px;\n  background: rgb(208, 208, 208);\n  box-sizing: border-box;\n  justify-content: space-between;\n  position: relative;\n`;\n\nconst LoadingContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  flex: 1;\n`;\n\nconst Submit = styled.span`\n  background-color: ${(props) => props.theme.color.yellow};\n  color: black;\n  margin: 20px 0;\n  padding: 10px 5px;\n  font-size: 20px;\n  text-align: center;\n  text-transform: uppercase;\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst Configurator = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n\nconst MIN_GIF_SIZE = 3;\n\nenum Size {\n  Short = 'short',\n  Medium = 'medium',\n  Long = 'long',\n}\n\nconst useGeneratePreview = (gif: GIF, configuration: Configuration): Preview => {\n  const [preview, setPreview] = useState<Preview>([]);\n  useEffect(() => {\n    if (gif.length !== 0 && configuration.start !== configuration.end) {\n      setPreview(getImages(gif, configuration));\n    }\n  }, [configuration, gif]);\n\n  return preview;\n};\n\nconst useConfiguration = (\n  gif: GIF,\n  initialConfiguration: Configuration | null\n): [Configuration, (configuration: Configuration) => void] => {\n  const [configuration, setConfiguration] = useState(\n    initialConfiguration === null ? {start: 0, end: getGifLength(gif), mode: Sample.Sample} : initialConfiguration\n  );\n\n  useEffect(() => {\n    if (null !== initialConfiguration) return;\n    if (0 === gif.length) return;\n\n    if (MIN_GIF_SIZE >= gif.length) {\n      setConfiguration({start: 0, end: getGifLength(gif), mode: Sample.Sample});\n    } else if (2000 >= getGifLength(gif)) {\n      setConfiguration({start: 0, end: getGifLength(gif), mode: Sample.Sample});\n    } else {\n      setConfiguration({start: 0, end: 2000, mode: Sample.Trim});\n    }\n  }, [gif, initialConfiguration]);\n\n  useEffect(() => {\n    const isDefaultSample =\n      0 === configuration.start && getGifLength(gif) === configuration.end && configuration.mode === Sample.Sample;\n    const isDefaultTrim = 0 === configuration.start && 2000 === configuration.end && configuration.mode === Sample.Trim;\n    const isEmptyConfiguration =\n      0 === configuration.start && 0 === configuration.end && configuration.mode === Sample.Sample;\n\n    if (\n      (!isDefaultSample && !isDefaultTrim && !isEmptyConfiguration) ||\n      (null !== initialConfiguration && initialConfiguration !== configuration)\n    )\n      sendEvent(UserEvent.ConfigurationChange, configuration);\n  }, [configuration, gif, initialConfiguration]);\n\n  return [configuration, setConfiguration];\n};\n\nconst useSize = (gif: GIF): Size => {\n  const [size, setSize] = useState<Size>(Size.Long);\n\n  useEffect(() => {\n    if (0 === gif.length) return;\n\n    if (MIN_GIF_SIZE >= gif.length) {\n      setSize(Size.Short);\n    } else if (2000 >= getGifLength(gif)) {\n      setSize(Size.Medium);\n    } else {\n      setSize(Size.Long);\n    }\n  }, [gif]);\n\n  return size;\n};\n\nconst LoopConfigurator = ({\n  initialConfiguration,\n  gif,\n  isEdit,\n  onLoopConfirmation,\n}: {\n  initialConfiguration: Configuration | null;\n  gif: GIF;\n  isEdit: boolean;\n  onLoopConfirmation: (configuration: Configuration | null, preview: Preview) => void;\n}) => {\n  const previous = null !== initialConfiguration;\n  const theme = useContext(ThemeContext);\n  const [configuration, setConfiguration] = useConfiguration(gif, initialConfiguration);\n  const preview = useGeneratePreview(gif, configuration);\n  const size = useSize(gif);\n\n  const onModeChange = useCallback(\n    (newMode: Sample) => {\n      const newStartEnd =\n        newMode === Sample.Trim\n          ? {\n              start: newMode === Sample.Trim ? 0 : configuration.start,\n              end: newMode === Sample.Trim ? 2000 : configuration.end,\n            }\n          : {};\n      setConfiguration({\n        ...configuration,\n        mode: newMode,\n        ...newStartEnd,\n      });\n    },\n    [configuration, setConfiguration]\n  );\n\n  const onCutChange = useCallback(\n    (start: number, end: number) => {\n      setConfiguration({...configuration, start, end});\n    },\n    [configuration, setConfiguration]\n  );\n\n  return (\n    <Container fullSize={isEdit}>\n      {0 === preview.length && (\n        <LoadingContainer>\n          <Bar>\n            <Progress />\n          </Bar>\n        </LoadingContainer>\n      )}\n      {gif.length !== 0 && configuration.start !== configuration.end && 0 !== preview.length && (\n        <>\n          <Configurator>\n            <Player preview={preview} width={theme.addModal.windowSize - theme.addModal.spacing * (isEdit ? 2 : 3)} />\n            {Size.Long === size && <SampleModeSelector mode={configuration.mode} onChange={onModeChange} />}\n            {Size.Short !== size && (\n              <Cutter\n                length={getGifLength(gif)}\n                start={configuration.start}\n                end={configuration.end}\n                mode={configuration.mode}\n                gif={gif}\n                onChange={onCutChange}\n              />\n            )}\n          </Configurator>\n          <Submit\n            data-testid=\"loop_configurator_confirm\"\n            onClick={() => {\n              onLoopConfirmation(configuration, preview);\n            }}\n          >\n            Confirm\n          </Submit>\n        </>\n      )}\n      {previous && !isEdit && (\n        <Back vertical={true} onClick={() => onLoopConfirmation(null, preview)}>\n          Back\n        </Back>\n      )}\n    </Container>\n  );\n};\n\nexport {LoopConfigurator};\n","import styled from 'styled-components';\n\nconst Container = styled.div<{isVisible: boolean}>`\n  z-index: 2;\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: rgba(0, 0, 0, 0.3);\n  opacity: ${(props) => (props.isVisible ? 1 : 0)};\n\n  transition: opacity 0.5s ease-in-out;\n`;\nconst Mask = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  opacity: 0;\n`;\n\nconst Modal = styled.div`\n  z-index: 9;\n  width: ${(props) => props.theme.addModal.windowSize}px;\n  height: ${(props) => props.theme.addModal.windowSize + props.theme.addModal.spacing}px;\n  background: ${(props) => props.theme.color.white};\n  overflow: hidden;\n  border-radius: 5px;\n  box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);\n  display: flex;\n  flex-direction: column;\n`;\n\nconst Header = styled.div`\n  height: ${(props) => props.theme.addModal.spacing}px;\n  width: ${(props) => props.theme.addModal.windowSize}px;\n  background: ${(props) => props.theme.color.grey};\n  color: white;\n  position: relative;\n  z-index: 10;\n`;\n\nconst Dismiss = styled.div`\n  position: absolute;\n  left: 0;\n  top: 0;\n  height: 100%;\n  line-height: ${(props) => props.theme.addModal.spacing}px;\n  width: ${(props) => props.theme.addModal.spacing}px;\n  text-align: center;\n  font-size: 30px;\n  font-weight: 100;\n\n  &:hover {\n    cursor: pointer;\n  }\n`;\n\nconst Title = styled.div`\n  width: 100%;\n  height: 100%;\n  line-height: ${(props) => props.theme.addModal.spacing}px;\n  text-align: center;\n  font-size: 25px;\n  font-weight: 200;\n`;\n\nexport {Container, Mask, Modal, Header, Dismiss, Title};\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 92;"],"sourceRoot":""}